{"remainingRequest":"/opt/lampp/htdocs/intellect/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/opt/lampp/htdocs/intellect/front/node_modules/vue-functional-calendar/src/components/FunctionalCalendar.vue?vue&type=script&lang=js&","dependencies":[{"path":"/opt/lampp/htdocs/intellect/front/node_modules/vue-functional-calendar/src/components/FunctionalCalendar.vue","mtime":1584416104303},{"path":"/opt/lampp/htdocs/intellect/front/node_modules/cache-loader/dist/cjs.js","mtime":1578848123391},{"path":"/opt/lampp/htdocs/intellect/front/node_modules/thread-loader/dist/cjs.js","mtime":1576704845283},{"path":"/opt/lampp/htdocs/intellect/front/node_modules/babel-loader/lib/index.js","mtime":1584734931761},{"path":"/opt/lampp/htdocs/intellect/front/node_modules/cache-loader/dist/cjs.js","mtime":1578848123391},{"path":"/opt/lampp/htdocs/intellect/front/node_modules/vue-loader/lib/index.js","mtime":1584734932632}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBoZWxwQ2FsZW5kYXIgZnJvbSAnLi4vYXNzZXRzL2pzL2NhbGVuZGFyJwppbXBvcnQge3Byb3BzQW5kRGF0YX0gZnJvbSAiLi4vbWl4aW5zL3Byb3BzQW5kRGF0YSI7CmltcG9ydCBUaW1lUGlja2VyIGZyb20gIi4vVGltZVBpY2tlciI7CmltcG9ydCBNb250aFllYXJQaWNrZXIgZnJvbSAiLi9Nb250aFllYXJQaWNrZXIiOwoKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogIkZ1bmN0aW9uYWxDYWxlbmRhciIsCiAgICBjb21wb25lbnRzOiB7TW9udGhZZWFyUGlja2VyLCBUaW1lUGlja2VyfSwKICAgIG1peGluczogW3Byb3BzQW5kRGF0YV0sCiAgICBjcmVhdGVkKCkgewogICAgICAgIHRoaXMuc2V0Q29uZmlncygpOwogICAgICAgIHRoaXMuaW5pdENhbGVuZGFyKCk7CiAgICB9LAogICAgbW91bnRlZCgpIHsKICAgICAgICBpZiAodGhpcy5mQ29uZmlncy5pc01vZGFsICYmICF0aGlzLmZDb25maWdzLndpdGhUaW1lUGlja2VyKSB7CiAgICAgICAgICAgIC8vIEV2ZW50CiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2FuQ2FsZW5kYXJDbG9zZWQpOwogICAgICAgIH0KCiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oaWRlTW9udGhZZWFyUGlja2VyKTsKICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5zZXRDYWxlbmRhclN0eWxlcyk7CgogICAgICAgIC8vIFJlYWN0cyB0byBleHRlcm5hbCBzZWxlY3RlZCBkYXRlcwogICAgICAgIHRoaXMuJHdhdGNoKCd2YWx1ZScsIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgICAgICBpZiAodGhpcy5mQ29uZmlncy5pc0RhdGVSYW5nZSkgewogICAgICAgICAgICAgICAgdGhpcy5jYWxlbmRhci5kYXRlUmFuZ2Uuc3RhcnQuZGF0ZSA9IHZhbHVlLmRhdGVSYW5nZS5zdGFydC5kYXRlIHx8IGZhbHNlOwogICAgICAgICAgICAgICAgdGhpcy5jYWxlbmRhci5kYXRlUmFuZ2UuZW5kLmRhdGUgPSB2YWx1ZS5kYXRlUmFuZ2UuZW5kLmRhdGUgfHwgZmFsc2UKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuY2FsZW5kYXIuc2VsZWN0ZWREYXRlID0gdmFsdWUuc2VsZWN0ZWREYXRlIHx8IGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICB9LCB7ZGVlcDogdHJ1ZX0pOwoKICAgICAgICB0aGlzLiR3YXRjaCgnc2hvd0NhbGVuZGFyJywgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICAgIGlmICh2YWx1ZSkKICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ29wZW5lZCcpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdjbG9zZWQnKTsKICAgICAgICB9LCB7aW1tZWRpYXRlOiB0cnVlLCBkZWVwOiB0cnVlfSk7CgogICAgICAgIHRoaXMuc2V0Q2FsZW5kYXJTdHlsZXMoKTsKICAgIH0sCiAgICBiZWZvcmVEZXN0cm95OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jYW5DYWxlbmRhckNsb3NlZCk7CiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oaWRlTW9udGhZZWFyUGlja2VyKTsKICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5zZXRDYWxlbmRhclN0eWxlcyk7CiAgICB9LAogICAgd2F0Y2g6IHsKICAgICAgICAnZkNvbmZpZ3MubWFya2VkRGF0ZXMnOiB7CiAgICAgICAgICAgIGhhbmRsZXIoKSB7CiAgICAgICAgICAgICAgICB0aGlzLm1hcmtDaG9vc2VEYXlzKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgICdmQ29uZmlncy5tYXJrZWREYXRlUmFuZ2UnOiB7CiAgICAgICAgICAgIGhhbmRsZXIoKSB7CiAgICAgICAgICAgICAgICB0aGlzLm1hcmtDaG9vc2VEYXlzKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgICdjYWxlbmRhci5zZWxlY3RlZERhdGUnOiB7CiAgICAgICAgICAgIGhhbmRsZXIodmFsKSB7CiAgICAgICAgICAgICAgICB0aGlzLmlucHV0LnNlbGVjdGVkRGF0ZSA9IHZhbCB8fCAnJzsKICAgICAgICAgICAgICAgIHRoaXMubWFya0Nob29zZURheXMoKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgJ2NhbGVuZGFyLmN1cnJlbnREYXRlJzogewogICAgICAgICAgICBoYW5kbGVyKHZhbHVlKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIHRoaXMuY2FsZW5kYXIpOwogICAgICAgICAgICAgICAgdGhpcy5jaGVja0xpbWl0cyh2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgICdjYWxlbmRhci5kYXRlUmFuZ2Uuc3RhcnQuZGF0ZSc6IHsKICAgICAgICAgICAgaGFuZGxlcih2YWwpIHsKICAgICAgICAgICAgICAgIHRoaXMuaW5wdXQuZGF0ZVJhbmdlLnN0YXJ0LmRhdGUgPSB2YWwgfHwgJyc7CiAgICAgICAgICAgICAgICB0aGlzLm1hcmtDaG9vc2VEYXlzKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgICdjYWxlbmRhci5kYXRlUmFuZ2UuZW5kLmRhdGUnOiB7CiAgICAgICAgICAgIGhhbmRsZXIodmFsKSB7CiAgICAgICAgICAgICAgICB0aGlzLmlucHV0LmRhdGVSYW5nZS5lbmQuZGF0ZSA9IHZhbCB8fCAnJzsKICAgICAgICAgICAgICAgIHRoaXMubWFya0Nob29zZURheXMoKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgJ2lucHV0LnNlbGVjdGVkRGF0ZSc6IHsKICAgICAgICAgICAgaGFuZGxlcih2YWwpIHsKICAgICAgICAgICAgICAgIHRoaXMuaW5wdXQuc2VsZWN0ZWREYXRlID0gdmFsID0gaGVscENhbGVuZGFyLm1hc2sodmFsKTsKICAgICAgICAgICAgICAgIGlmIChoZWxwQ2FsZW5kYXIuZ2V0RGF0ZUZyb21Gb3JtYXQodmFsKS5nZXRNb250aCgpKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWxlbmRhci5zZWxlY3RlZERhdGUgPSB2YWw7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXJrQ2hvb3NlRGF5cygpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIFR5cGVhYmxlCiAgICAgICAgICAgICAgICBpZiAoaGVscENhbGVuZGFyLmNoZWNrVmFsaWREYXRlKHZhbCkgJiYgdGhpcy5mQ29uZmlncy5pc1R5cGVhYmxlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5DaG9vc2VEYXRlKHZhbCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgICdpbnB1dC5kYXRlUmFuZ2Uuc3RhcnQuZGF0ZSc6IHsKICAgICAgICAgICAgaGFuZGxlcih2YWwpIHsKICAgICAgICAgICAgICAgIHRoaXMuaW5wdXQuZGF0ZVJhbmdlLnN0YXJ0LmRhdGUgPSB2YWwgPSBoZWxwQ2FsZW5kYXIubWFzayh2YWwpOwogICAgICAgICAgICAgICAgaWYgKGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdCh2YWwpLmdldE1vbnRoKCkpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbGVuZGFyLmRhdGVSYW5nZS5zdGFydC5kYXRlID0gdmFsOwogICAgICAgICAgICAgICAgICAgIHRoaXMubWFya0Nob29zZURheXMoKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBUeXBlYWJsZQogICAgICAgICAgICAgICAgaWYgKGhlbHBDYWxlbmRhci5jaGVja1ZhbGlkRGF0ZSh2YWwpICYmIHRoaXMuZkNvbmZpZ3MuaXNUeXBlYWJsZSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuQ2hvb3NlRGF0ZSh2YWwpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICAnaW5wdXQuZGF0ZVJhbmdlLmVuZC5kYXRlJzogewogICAgICAgICAgICBoYW5kbGVyKHZhbCkgewogICAgICAgICAgICAgICAgdGhpcy5pbnB1dC5kYXRlUmFuZ2UuZW5kLmRhdGUgPSB2YWwgPSBoZWxwQ2FsZW5kYXIubWFzayh2YWwpOwogICAgICAgICAgICAgICAgaWYgKGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdCh2YWwpLmdldE1vbnRoKCkpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbGVuZGFyLmRhdGVSYW5nZS5lbmQuZGF0ZSA9IHZhbDsKICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcmtDaG9vc2VEYXlzKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gVHlwZWFibGUKICAgICAgICAgICAgICAgIGlmIChoZWxwQ2FsZW5kYXIuY2hlY2tWYWxpZERhdGUodmFsKSAmJiB0aGlzLmZDb25maWdzLmlzVHlwZWFibGUpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLkNob29zZURhdGUodmFsKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgaW5pdENhbGVuZGFyKCkgewogICAgICAgICAgICAvLyBTZXQgSGVscCBDYWxlbmRhciBDb25maWdzCiAgICAgICAgICAgIGhlbHBDYWxlbmRhci5jb25maWdzLnN1bmRheVN0YXJ0ID0gdGhpcy5mQ29uZmlncy5zdW5kYXlTdGFydDsKICAgICAgICAgICAgaGVscENhbGVuZGFyLmNvbmZpZ3MubGVmdEFuZFJpZ2h0RGF5cyA9IHRoaXMuY2hlY2tIaWRkZW5FbGVtZW50KCdsZWZ0QW5kUmlnaHREYXlzJyk7CiAgICAgICAgICAgIGhlbHBDYWxlbmRhci5jb25maWdzLmRhdGVGb3JtYXQgPSB0aGlzLmZDb25maWdzLmRhdGVGb3JtYXQ7CiAgICAgICAgICAgIGhlbHBDYWxlbmRhci5jb25maWdzLmRheU5hbWVzID0gdGhpcy5mQ29uZmlncy5kYXlOYW1lczsKICAgICAgICAgICAgaGVscENhbGVuZGFyLmNvbmZpZ3MubW9udGhOYW1lcyA9IHRoaXMuZkNvbmZpZ3MubW9udGhOYW1lczsKCiAgICAgICAgICAgIHRoaXMuc2V0Q2FsZW5kYXJEYXRhKCk7CiAgICAgICAgICAgIHRoaXMubGlzdFJlbmRlcmluZygpOwogICAgICAgICAgICB0aGlzLm1hcmtDaG9vc2VEYXlzKCk7CiAgICAgICAgICAgIHRoaXMuY2hlY2tMaW1pdHModGhpcy5jYWxlbmRhci5jdXJyZW50RGF0ZSk7CiAgICAgICAgfSwKICAgICAgICB1cGRhdGVDYWxlbmRhcigpIHsKICAgICAgICAgICAgdGhpcy5zZXRFeGlzdGluZ0NhbGVuZGFyRGF0YSgpOwogICAgICAgICAgICB0aGlzLmxpc3RSZW5kZXJpbmcoKTsKICAgICAgICAgICAgdGhpcy5tYXJrQ2hvb3NlRGF5cygpOwogICAgICAgIH0sCiAgICAgICAgc2V0Q2FsZW5kYXJEYXRhKCkgewogICAgICAgICAgICBsZXQgZGF0ZSA9IHRoaXMuY2FsZW5kYXIuY3VycmVudERhdGU7CiAgICAgICAgICAgIGRhdGUgPSBuZXcgRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIGRhdGUuZ2V0TW9udGgoKSAtIDEpOwoKICAgICAgICAgICAgdGhpcy5saXN0Q2FsZW5kYXJzID0gW107CgogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZkNvbmZpZ3MuY2FsZW5kYXJzQ291bnQ7IGkrKykgewogICAgICAgICAgICAgICAgZGF0ZSA9IG5ldyBEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSwgZGF0ZS5nZXRNb250aCgpICsgMSk7CgogICAgICAgICAgICAgICAgbGV0IGNhbGVuZGFyID0gewogICAgICAgICAgICAgICAgICAgIGtleTogaSwKICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRlLAogICAgICAgICAgICAgICAgICAgIGRhdGVUb3A6IGAke3RoaXMuZkNvbmZpZ3MubW9udGhOYW1lc1tkYXRlLmdldE1vbnRoKCldfSAke2RhdGUuZ2V0RnVsbFllYXIoKX1gLAogICAgICAgICAgICAgICAgICAgIG1vbnRoOiB0aGlzLmZDb25maWdzLm1vbnRoTmFtZXNbZGF0ZS5nZXRNb250aCgpXSwKICAgICAgICAgICAgICAgICAgICB5ZWFyOiBkYXRlLmdldEZ1bGxZZWFyKCksCiAgICAgICAgICAgICAgICAgICAgd2Vla3M6IGhlbHBDYWxlbmRhci5nZXRGaW5hbGl6ZWRXZWVrcyhkYXRlLmdldE1vbnRoKCksIGRhdGUuZ2V0RnVsbFllYXIoKSkKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgdGhpcy5saXN0Q2FsZW5kYXJzLnB1c2goY2FsZW5kYXIpOwoKICAgICAgICAgICAgICAgIGlmICghdGhpcy5mQ29uZmlncy5pc011bHRpcGxlKSB7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHNldEV4aXN0aW5nQ2FsZW5kYXJEYXRhKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubGlzdENhbGVuZGFycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgbGV0IGNhbGVuZGFyID0gdGhpcy5saXN0Q2FsZW5kYXJzW2ldOwogICAgICAgICAgICAgICAgbGV0IGRhdGUgPSBjYWxlbmRhci5kYXRlOwoKICAgICAgICAgICAgICAgIHRoaXMuJHNldCh0aGlzLmxpc3RDYWxlbmRhcnMsIGksIHsKICAgICAgICAgICAgICAgICAgICBrZXk6IGNhbGVuZGFyLmtleSwKICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRlLAogICAgICAgICAgICAgICAgICAgIGRhdGVUb3A6IGAke3RoaXMuZkNvbmZpZ3MubW9udGhOYW1lc1tkYXRlLmdldE1vbnRoKCldfSAke2RhdGUuZ2V0RnVsbFllYXIoKX1gLAogICAgICAgICAgICAgICAgICAgIG1vbnRoOiB0aGlzLmZDb25maWdzLm1vbnRoTmFtZXNbZGF0ZS5nZXRNb250aCgpXSwKICAgICAgICAgICAgICAgICAgICB5ZWFyOiBkYXRlLmdldEZ1bGxZZWFyKCksCiAgICAgICAgICAgICAgICAgICAgd2Vla3M6IGhlbHBDYWxlbmRhci5nZXRGaW5hbGl6ZWRXZWVrcyhkYXRlLmdldE1vbnRoKCksIGRhdGUuZ2V0RnVsbFllYXIoKSkKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGlmICghdGhpcy5mQ29uZmlncy5pc011bHRpcGxlKSB7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHNldENvbmZpZ3MoKSB7CiAgICAgICAgICAgIGxldCB2bSA9IHRoaXM7CiAgICAgICAgICAgIGxldCBnbG9iYWxPcHRpb25zOwogICAgICAgICAgICBpZiAodHlwZW9mIHZtLiRnZXRPcHRpb25zICE9PSAidW5kZWZpbmVkIikgewogICAgICAgICAgICAgICAgLy8gR2xvYmFsIE9wdGlvbnMKICAgICAgICAgICAgICAgIGdsb2JhbE9wdGlvbnMgPSB2bS4kZ2V0T3B0aW9ucygpOwogICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoZ2xvYmFsT3B0aW9ucykuZm9yRWFjaChmdW5jdGlvbiAob2JqZWN0S2V5KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAodm0uZkNvbmZpZ3Nbb2JqZWN0S2V5XSkgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZtLiRzZXQodm0uZkNvbmZpZ3MsIG9iamVjdEtleSwgZ2xvYmFsT3B0aW9uc1tvYmplY3RLZXldKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHR5cGVvZiAodm0uY29uZmlncykgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyh2bS5mQ29uZmlncykuZm9yRWFjaChmdW5jdGlvbiAob2JqZWN0S2V5KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAodm0uY29uZmlnc1tvYmplY3RLZXldKSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IEZyb20gQ29uZmlncwogICAgICAgICAgICAgICAgICAgICAgICB2bS4kc2V0KHZtLmZDb25maWdzLCBvYmplY3RLZXksIHZtLmNvbmZpZ3Nbb2JqZWN0S2V5XSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyh2bS4kcHJvcHMpLmZvckVhY2goZnVuY3Rpb24gKG9iamVjdEtleSkgewogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKHZtLmZDb25maWdzW29iamVjdEtleV0pICE9PSAidW5kZWZpbmVkIiAmJgogICAgICAgICAgICAgICAgICAgICAgICB0eXBlb2YgKHZtLiRwcm9wc1tvYmplY3RLZXldKSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdm0uJHNldCh2bS5mQ29uZmlncywgb2JqZWN0S2V5LCB2bS4kcHJvcHNbb2JqZWN0S2V5XSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCgogICAgICAgICAgICAvLyBJcyBNb2RhbAogICAgICAgICAgICBpZiAodm0uZkNvbmZpZ3MuaXNNb2RhbCkgdm0uc2hvd0NhbGVuZGFyID0gZmFsc2U7CgogICAgICAgICAgICAvLyBQbGFjZWhvbGRlcgogICAgICAgICAgICBpZiAoIXZtLmZDb25maWdzLnBsYWNlaG9sZGVyKSB2bS5mQ29uZmlncy5wbGFjZWhvbGRlciA9IHZtLmZDb25maWdzLmRhdGVGb3JtYXQ7CgogICAgICAgICAgICBpZiAodHlwZW9mIHZtLm5ld0N1cnJlbnREYXRlICE9PSAidW5kZWZpbmVkIikgewogICAgICAgICAgICAgICAgdm0uY2FsZW5kYXIuY3VycmVudERhdGUgPSB2bS5uZXdDdXJyZW50RGF0ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU3VuZGF5IFN0YXJ0CiAgICAgICAgICAgIGlmICh2bS5mQ29uZmlncy5zdW5kYXlTdGFydCkgewogICAgICAgICAgICAgICAgbGV0IGRheU5hbWVzID0gdm0uZkNvbmZpZ3MuZGF5TmFtZXM7CiAgICAgICAgICAgICAgICBsZXQgc3VuZGF5TmFtZSA9IGRheU5hbWVzW2RheU5hbWVzLmxlbmd0aCAtIDFdOwogICAgICAgICAgICAgICAgZGF5TmFtZXMuc3BsaWNlKGRheU5hbWVzLmxlbmd0aCAtIDEsIDEpOwogICAgICAgICAgICAgICAgZGF5TmFtZXMudW5zaGlmdChzdW5kYXlOYW1lKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgbGlzdFJlbmRlcmluZygpIHsKICAgICAgICAgICAgbGV0IHZtID0gdGhpczsKCiAgICAgICAgICAgIC8vIEVhY2ggQ2FsZW5kYXJzCiAgICAgICAgICAgIHZtLmxpc3RDYWxlbmRhcnMuZm9yRWFjaChmdW5jdGlvbiAoY2FsZW5kYXIpIHsKICAgICAgICAgICAgICAgIC8vIFNldCBDYWxlbmRhciBXZWVrcwogICAgICAgICAgICAgICAgY2FsZW5kYXIud2Vla3MuZm9yRWFjaChmdW5jdGlvbiAod2VlaykgewoKICAgICAgICAgICAgICAgICAgICBsZXQgZmluYWxpemVkRGF5cyA9IFtdOwoKICAgICAgICAgICAgICAgICAgICB3ZWVrLmRheXMuZm9yRWFjaChmdW5jdGlvbiAoZGF5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkYXRlID0gbmV3IERhdGUoZGF5LnllYXIsIGRheS5tb250aCwgZGF5LmRheSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBub3cgPSBuZXcgRGF0ZSgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGlzVG9kYXkgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGUuc2V0SG91cnMoMCwgMCwgMCwgMCk7CiAgICAgICAgICAgICAgICAgICAgICAgIG5vdy5zZXRIb3VycygwLCAwLCAwLCAwKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRlLmdldFRpbWUoKSA9PT0gbm93LmdldFRpbWUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNUb2RheSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjaGVja01hcmtlZDsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2l0aCBDdXN0b20gQ2xhc3NlcwogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZtLmZDb25maWdzLm1hcmtlZERhdGVzWzBdID09PSAib2JqZWN0IikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tNYXJrZWQgPSB2bS5mQ29uZmlncy5tYXJrZWREYXRlcy5maW5kKGZ1bmN0aW9uIChtYXJrRGF0ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXJrRGF0ZS5kYXRlID09PSBoZWxwQ2FsZW5kYXIuZm9ybWF0RGF0ZShkYXRlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBXaXRob3V0IENsYXNzZXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrTWFya2VkID0gdm0uZkNvbmZpZ3MubWFya2VkRGF0ZXMuZmluZChmdW5jdGlvbiAobWFya0RhdGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWFya0RhdGUgPT09IGhlbHBDYWxlbmRhci5mb3JtYXREYXRlKGRhdGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZtLmNhbGVuZGFyLmRhdGVSYW5nZS5zdGFydC5kYXRlID09PSBoZWxwQ2FsZW5kYXIuZm9ybWF0RGF0ZShkYXRlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tNYXJrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBsZXQgaXNNYXJrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjaGVja01hcmtlZCAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzTWFya2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxpemVkRGF5cy5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheTogZGF5LmRheSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGhlbHBDYWxlbmRhci5mb3JtYXREYXRlKGRhdGUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZTogZGF5LmhpZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc01vdXNlVG9MZWZ0OiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzTW91c2VUb1JpZ2h0OiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzSG92ZXJlZDogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0RhdGVSYW5nZVN0YXJ0OiB2bS5jaGVja0RhdGVSYW5nZVN0YXJ0KGhlbHBDYWxlbmRhci5mb3JtYXREYXRlKGRhdGUpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzRGF0ZVJhbmdlRW5kOiB2bS5jaGVja0RhdGVSYW5nZUVuZChoZWxwQ2FsZW5kYXIuZm9ybWF0RGF0ZShkYXRlKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlTGVmdEFuZFJpZ2h0RGF5czogZGF5LmhpZGVMZWZ0QW5kUmlnaHREYXlzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNUb2RheTogaXNUb2RheSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzTWFya2VkOiBpc01hcmtlZAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgd2Vlay5kYXlzID0gZmluYWxpemVkRGF5czsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKCiAgICAgICAgfSwKICAgICAgICBjbGlja0RheShpdGVtKSB7CiAgICAgICAgICAgIGlmICghdGhpcy5mQ29uZmlncy5pc0RhdGVSYW5nZSAmJiAhdGhpcy5mQ29uZmlncy5pc0RhdGVQaWNrZXIgJiYgIXRoaXMuZkNvbmZpZ3MuaXNNdWx0aXBsZURhdGVQaWNrZXIpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9EaXNhYmxlZCBEYXRlcyAtIFN0YXJ0CgogICAgICAgICAgICAvLyBEaXNhYmxlIGRheXMgb2Ygd2VlayBpZiBzZXQgaW4gY29uZmlndXJhdGlvbgogICAgICAgICAgICBsZXQgZGF0ZURheSA9IGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdChpdGVtLmRhdGUpLmdldERheSgpIC0gMTsKICAgICAgICAgICAgaWYgKGRhdGVEYXkgPT09IC0xKSB7CiAgICAgICAgICAgICAgICBkYXRlRGF5ID0gNjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IGRheU9mV2Vla1N0cmluZyA9IHRoaXMuZkNvbmZpZ3MuZGF5TmFtZXNbZGF0ZURheV07CiAgICAgICAgICAgIGlmICh0aGlzLmZDb25maWdzLmRpc2FibGVkRGF5TmFtZXMuaW5jbHVkZXMoZGF5T2ZXZWVrU3RyaW5nKSB8fCB0aGlzLmlzRGlzYWJsZWREYXRlKGl0ZW0uZGF0ZSkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9EaXNhYmxlZCBEYXRlcyAtIEVuZAoKICAgICAgICAgICAgLy8gTGltaXRzCiAgICAgICAgICAgIGlmICh0aGlzLmZDb25maWdzLmxpbWl0cykgewogICAgICAgICAgICAgICAgbGV0IG1pbiA9IGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdCh0aGlzLmZDb25maWdzLmxpbWl0cy5taW4pLmdldFRpbWUoKTsKICAgICAgICAgICAgICAgIGxldCBtYXggPSBoZWxwQ2FsZW5kYXIuZ2V0RGF0ZUZyb21Gb3JtYXQodGhpcy5mQ29uZmlncy5saW1pdHMubWF4KS5nZXRUaW1lKCk7CiAgICAgICAgICAgICAgICBsZXQgZGF0ZSA9IGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdChpdGVtLmRhdGUpLmdldFRpbWUoKTsKCiAgICAgICAgICAgICAgICBpZiAoZGF0ZSA8IG1pbiB8fCBkYXRlID4gbWF4KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEYXRlIFJhbmdlCiAgICAgICAgICAgIGlmICh0aGlzLmZDb25maWdzLmlzRGF0ZVJhbmdlKSB7CgogICAgICAgICAgICAgICAgbGV0IGNsaWNrRGF0ZSA9IGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdChpdGVtLmRhdGUpLmdldFRpbWUoKTsKCiAgICAgICAgICAgICAgICBsZXQgc3RhcnREYXRlID0gZmFsc2U7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5jYWxlbmRhci5kYXRlUmFuZ2Uuc3RhcnQuZGF0ZSkgewogICAgICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZSA9IGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdCh0aGlzLmNhbGVuZGFyLmRhdGVSYW5nZS5zdGFydC5kYXRlKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBUd28gZGF0ZXMgaXMgbm90IGVtcHR5CiAgICAgICAgICAgICAgICBpZiAodGhpcy5jYWxlbmRhci5kYXRlUmFuZ2Uuc3RhcnQuZGF0ZSAhPT0gZmFsc2UgJiYgdGhpcy5jYWxlbmRhci5kYXRlUmFuZ2UuZW5kLmRhdGUgIT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWxlbmRhci5kYXRlUmFuZ2Uuc3RhcnQuZGF0ZSA9IGl0ZW0uZGF0ZTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbGVuZGFyLmRhdGVSYW5nZS5lbmQuZGF0ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIC8vIE5vdCBkYXRlIHNlbGVjdGVkCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY2FsZW5kYXIuZGF0ZVJhbmdlLnN0YXJ0LmRhdGUgPT09IGZhbHNlICYmIHRoaXMuY2FsZW5kYXIuZGF0ZVJhbmdlLmVuZC5kYXRlID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuY2FsZW5kYXIuZGF0ZVJhbmdlLnN0YXJ0LmRhdGUgPSBpdGVtLmRhdGU7CiAgICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgRGF0ZSBub3QgZW1wdHksIGNob3NlIGRhdGUgPiBzdGFydCBkYXRlCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY2FsZW5kYXIuZGF0ZVJhbmdlLmVuZC5kYXRlID09PSBmYWxzZSAmJiAoY2xpY2tEYXRlID4gc3RhcnREYXRlLmdldFRpbWUoKSkpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbGVuZGFyLmRhdGVSYW5nZS5lbmQuZGF0ZSA9IGl0ZW0uZGF0ZTsKICAgICAgICAgICAgICAgICAgICAvLyBTdGFydCBkYXRlIG5vdCBlbXB0eSwgY2hvc2UgZGF0ZSA8PSBzdGFydCBkYXRlIChhbHNvIHNhbWUgZGF0ZSByYW5nZSBzZWxlY3QpCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY2FsZW5kYXIuZGF0ZVJhbmdlLnN0YXJ0LmRhdGUgIT09IGZhbHNlICYmIChjbGlja0RhdGUgPD0gc3RhcnREYXRlLmdldFRpbWUoKSkpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbGVuZGFyLmRhdGVSYW5nZS5lbmQuZGF0ZSA9IHRoaXMuY2FsZW5kYXIuZGF0ZVJhbmdlLnN0YXJ0LmRhdGU7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWxlbmRhci5kYXRlUmFuZ2Uuc3RhcnQuZGF0ZSA9IGl0ZW0uZGF0ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvL0dldCBudW1iZXIgb2YgZGF5cyBiZXR3ZWVuIGRhdGUgcmFuZ2UgZGF0ZXMKICAgICAgICAgICAgICAgIGlmICh0aGlzLmNhbGVuZGFyLmRhdGVSYW5nZS5zdGFydC5kYXRlICE9PSBmYWxzZSAmJiB0aGlzLmNhbGVuZGFyLmRhdGVSYW5nZS5lbmQuZGF0ZSAhPT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgb25lRGF5ID0gMjQgKiA2MCAqIDYwICogMTAwMDsKICAgICAgICAgICAgICAgICAgICBsZXQgZmlyc3REYXRlID0gaGVscENhbGVuZGFyLmdldERhdGVGcm9tRm9ybWF0KHRoaXMuY2FsZW5kYXIuZGF0ZVJhbmdlLnN0YXJ0LmRhdGUpOwogICAgICAgICAgICAgICAgICAgIGxldCBzZWNvbmREYXRlID0gaGVscENhbGVuZGFyLmdldERhdGVGcm9tRm9ybWF0KHRoaXMuY2FsZW5kYXIuZGF0ZVJhbmdlLmVuZC5kYXRlKTsKICAgICAgICAgICAgICAgICAgICBsZXQgZGlmZkRheXMgPSBNYXRoLnJvdW5kKE1hdGguYWJzKChmaXJzdERhdGUuZ2V0VGltZSgpIC0gc2Vjb25kRGF0ZS5nZXRUaW1lKCkpIC8gKG9uZURheSkpKTsKICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbVRpbWUgPSBoZWxwQ2FsZW5kYXIuZ2V0RGF0ZUZyb21Gb3JtYXQoaXRlbS5kYXRlKS5nZXRUaW1lKCk7CgogICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3NlbGVjdGVkRGF5c0NvdW50JywgZGlmZkRheXMpOwoKICAgICAgICAgICAgICAgICAgICAvLyBJcyBBdXRvIENsb3NlYWJsZQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZDb25maWdzLmlzTW9kYWwgJiYgdGhpcy5mQ29uZmlncy5pc0F1dG9DbG9zZWFibGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93Q2FsZW5kYXIgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9CgoKICAgICAgICAgICAgICAgICAgICAvLyBNaW5pbXVtIFNlbGVjdGVkIERheXMKICAgICAgICAgICAgICAgICAgICBsZXQgbWluU2VsRGF5cyA9IHRoaXMuZkNvbmZpZ3MubWluU2VsRGF5czsKCiAgICAgICAgICAgICAgICAgICAgaWYgKG1pblNlbERheXMgJiYgaXRlbVRpbWUgPj0gc3RhcnREYXRlLmdldFRpbWUoKSAmJiBkaWZmRGF5cyA8IG1pblNlbERheXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnREYXRlLnNldERhdGUoc3RhcnREYXRlLmdldERhdGUoKSArIChtaW5TZWxEYXlzIC0gMSkpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbGVuZGFyLmRhdGVSYW5nZS5lbmQuZGF0ZSA9IGhlbHBDYWxlbmRhci5mb3JtYXREYXRlKHN0YXJ0RGF0ZSk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAobWluU2VsRGF5cyAmJiBpdGVtVGltZSA8IHN0YXJ0RGF0ZS5nZXRUaW1lKCkgJiYgZGlmZkRheXMgPCBtaW5TZWxEYXlzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZS5zZXREYXRlKHN0YXJ0RGF0ZS5nZXREYXRlKCkgLSAobWluU2VsRGF5cyAtIDEpKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWxlbmRhci5kYXRlUmFuZ2Uuc3RhcnQuZGF0ZSA9IGhlbHBDYWxlbmRhci5mb3JtYXREYXRlKHN0YXJ0RGF0ZSk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAvLyBNYXhpbXVtIFNlbGVjdGVkIERheXMKICAgICAgICAgICAgICAgICAgICBsZXQgbWF4U2VsRGF5cyA9IHRoaXMuZkNvbmZpZ3MubWF4U2VsRGF5czsKCiAgICAgICAgICAgICAgICAgICAgaWYgKG1heFNlbERheXMgJiYgaXRlbVRpbWUgPj0gc3RhcnREYXRlLmdldFRpbWUoKSAmJiBkaWZmRGF5cyA+PSBtYXhTZWxEYXlzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZS5zZXREYXRlKHN0YXJ0RGF0ZS5nZXREYXRlKCkgKyAobWF4U2VsRGF5cyAtIDEpKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWxlbmRhci5kYXRlUmFuZ2UuZW5kLmRhdGUgPSBoZWxwQ2FsZW5kYXIuZm9ybWF0RGF0ZShzdGFydERhdGUpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKG1heFNlbERheXMgJiYgaXRlbVRpbWUgPCBzdGFydERhdGUuZ2V0VGltZSgpICYmIGRpZmZEYXlzID49IG1heFNlbERheXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnREYXRlLnNldERhdGUoc3RhcnREYXRlLmdldERhdGUoKSAtIChtYXhTZWxEYXlzIC0gMSkpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbGVuZGFyLmRhdGVSYW5nZS5zdGFydC5kYXRlID0gaGVscENhbGVuZGFyLmZvcm1hdERhdGUoc3RhcnREYXRlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCB0aGlzLmNhbGVuZGFyKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmZDb25maWdzLmlzRGF0ZVBpY2tlcikgewogICAgICAgICAgICAgICAgdGhpcy5jYWxlbmRhci5zZWxlY3RlZERhdGUgPSBpdGVtLmRhdGU7CiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIHRoaXMuY2FsZW5kYXIpOwoKICAgICAgICAgICAgICAgIC8vIElzIEF1dG8gQ2xvc2VhYmxlCiAgICAgICAgICAgICAgICBpZiAodGhpcy5mQ29uZmlncy5pc01vZGFsICYmIHRoaXMuZkNvbmZpZ3MuaXNBdXRvQ2xvc2VhYmxlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93Q2FsZW5kYXIgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmZDb25maWdzLmlzTXVsdGlwbGVEYXRlUGlja2VyKSB7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5jYWxlbmRhci5zZWxlY3RlZERhdGVzLmZpbmQoZGF0ZSA9PiBkYXRlLmRhdGUgPT09IGl0ZW0uZGF0ZSkpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgZGF0ZUluZGV4ID0gdGhpcy5jYWxlbmRhci5zZWxlY3RlZERhdGVzLmZpbmRJbmRleChkYXRlID0+IGRhdGUuZGF0ZSA9PT0gaXRlbS5kYXRlKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbGVuZGFyLnNlbGVjdGVkRGF0ZXMuc3BsaWNlKGRhdGVJbmRleCwgMSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGxldCBkYXRlID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0RGF0ZUZvcm1hdCk7CiAgICAgICAgICAgICAgICAgICAgZGF0ZS5kYXRlID0gaXRlbS5kYXRlOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY2FsZW5kYXIuc2VsZWN0ZWREYXRlcy5wdXNoKGRhdGUpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgdGhpcy5jYWxlbmRhcik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMubWFya0Nob29zZURheXMoKTsKCiAgICAgICAgICAgIC8vIFRpbWUgUGlja2VyCiAgICAgICAgICAgIGlmICh0aGlzLmZDb25maWdzLndpdGhUaW1lUGlja2VyKSB7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5mQ29uZmlncy5pc0RhdGVSYW5nZSB8fCB0aGlzLmZDb25maWdzLmlzRGF0ZVBpY2tlcikgewogICAgICAgICAgICAgICAgICAgIHRoaXMub3BlblRpbWVQaWNrZXIoKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAodGhpcy5jYWxlbmRhci5zZWxlY3RlZERhdGVzLmZpbmQoZGF0ZSA9PiBkYXRlLmRhdGUgPT09IGl0ZW0uZGF0ZSkgJiYgdGhpcy5mQ29uZmlncy5pc011bHRpcGxlRGF0ZVBpY2tlcikgewogICAgICAgICAgICAgICAgICAgIHRoaXMub3BlblRpbWVQaWNrZXIoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy4kZW1pdCgnY2hvc2VEYXknLCBpdGVtKTsKICAgICAgICB9LAogICAgICAgIG1hcmtDaG9vc2VEYXlzKCkgewogICAgICAgICAgICBsZXQgdm0gPSB0aGlzOwogICAgICAgICAgICBsZXQgc3RhcnREYXRlID0gdm0uY2FsZW5kYXIuZGF0ZVJhbmdlLnN0YXJ0LmRhdGU7CiAgICAgICAgICAgIGxldCBlbmREYXRlID0gdm0uY2FsZW5kYXIuZGF0ZVJhbmdlLmVuZC5kYXRlOwoKICAgICAgICAgICAgdGhpcy5saXN0Q2FsZW5kYXJzLmZvckVhY2goKGNhbGVuZGFyKSA9PiB7CiAgICAgICAgICAgICAgICBjYWxlbmRhci53ZWVrcy5mb3JFYWNoKCh3ZWVrKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgd2Vlay5kYXlzLmZvckVhY2goKGRheSkgPT4gewoKICAgICAgICAgICAgICAgICAgICAgICAgZGF5LmlzTWFya2VkID0gZmFsc2U7CgogICAgICAgICAgICAgICAgICAgICAgICAvLyBEYXRlIFBpY2tlcgogICAgICAgICAgICAgICAgICAgICAgICBpZiAodm0uZkNvbmZpZ3MuaXNEYXRlUGlja2VyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jYWxlbmRhci5zZWxlY3RlZERhdGUgPT09IGRheS5kYXRlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheS5pc01hcmtlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodm0uZkNvbmZpZ3MuaXNNdWx0aXBsZURhdGVQaWNrZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2bS5jYWxlbmRhci5zZWxlY3RlZERhdGVzLmZpbmQoZGF0ZSA9PiBkYXRlLmRhdGUgPT09IGRheS5kYXRlKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXkuaXNNYXJrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5LmlzTW91c2VUb0xlZnQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheS5pc01vdXNlVG9SaWdodCA9IGZhbHNlOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIERhdGUgUmFuZ2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGFydERhdGUgPT09IGRheS5kYXRlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5LmlzTW91c2VUb0xlZnQgPSAhIWVuZERhdGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5LmlzTWFya2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW5kRGF0ZSA9PT0gZGF5LmRhdGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXkuaXNNb3VzZVRvUmlnaHQgPSAhIWVuZERhdGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5LmlzTWFya2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhcnREYXRlICYmIHN0YXJ0RGF0ZSA9PT0gZW5kRGF0ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheS5pc01vdXNlVG9MZWZ0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5LmlzTW91c2VUb1JpZ2h0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0RGF0ZSAmJiBlbmREYXRlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdChkYXkuZGF0ZSkuZ2V0VGltZSgpID4gaGVscENhbGVuZGFyLmdldERhdGVGcm9tRm9ybWF0KHN0YXJ0RGF0ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgaGVscENhbGVuZGFyLmdldERhdGVGcm9tRm9ybWF0KGRheS5kYXRlKSA8IGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdChlbmREYXRlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXkuaXNNYXJrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZkNvbmZpZ3MubWFya2VkRGF0ZXMuaW5jbHVkZXMoZGF5LmRhdGUpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5LmlzTWFya2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGRheU1vdXNlT3Zlcih3ZWVrX2tleSwgZGF0ZSkgewogICAgICAgICAgICBpZiAoIXRoaXMuZkNvbmZpZ3MuaXNEYXRlUmFuZ2UpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gTGltaXRzCiAgICAgICAgICAgIGlmICh0aGlzLmZDb25maWdzLmxpbWl0cykgewogICAgICAgICAgICAgICAgbGV0IGxpbWl0TWluID0gaGVscENhbGVuZGFyLmdldERhdGVGcm9tRm9ybWF0KHRoaXMuZkNvbmZpZ3MubGltaXRzLm1pbikuZ2V0VGltZSgpOwogICAgICAgICAgICAgICAgbGV0IGxpbWl0TWF4ID0gaGVscENhbGVuZGFyLmdldERhdGVGcm9tRm9ybWF0KHRoaXMuZkNvbmZpZ3MubGltaXRzLm1heCkuZ2V0VGltZSgpOwogICAgICAgICAgICAgICAgbGV0IGxpbWl0RGF0ZSA9IGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdChkYXRlKS5nZXRUaW1lKCk7CgogICAgICAgICAgICAgICAgaWYgKGxpbWl0RGF0ZSA8IGxpbWl0TWluIHx8IGxpbWl0RGF0ZSA+IGxpbWl0TWF4KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoKHRoaXMuY2FsZW5kYXIuZGF0ZVJhbmdlLnN0YXJ0LmRhdGUgPT09IGZhbHNlIHx8IHRoaXMuY2FsZW5kYXIuZGF0ZVJhbmdlLmVuZC5kYXRlID09PSBmYWxzZSkKICAgICAgICAgICAgICAgICYmICh0aGlzLmNhbGVuZGFyLmRhdGVSYW5nZS5zdGFydC5kYXRlICE9PSBmYWxzZSB8fCB0aGlzLmNhbGVuZGFyLmRhdGVSYW5nZS5lbmQuZGF0ZSAhPT0gZmFsc2UpKSB7CgogICAgICAgICAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0aGlzLmxpc3RDYWxlbmRhcnMubGVuZ3RoOyBlKyspIHsKICAgICAgICAgICAgICAgICAgICBsZXQgY2FsZW5kYXIgPSB0aGlzLmxpc3RDYWxlbmRhcnNbZV07CgogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGYgPSAwOyBmIDwgY2FsZW5kYXIud2Vla3MubGVuZ3RoOyBmKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHdlZWsgPSBjYWxlbmRhci53ZWVrc1tmXTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd2Vlay5kYXlzLmxlbmd0aDsgaSsrKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGl0ZW0gPSB3ZWVrLmRheXNbaV07CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0Q2FsZW5kYXJzW2VdLndlZWtzW2ZdLmRheXNbaV0uaXNIb3ZlcmVkID0gZmFsc2U7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uZGF0ZSAhPT0gdGhpcy5jYWxlbmRhci5kYXRlUmFuZ2Uuc3RhcnQuZGF0ZSAmJiAhdGhpcy5mQ29uZmlncy5tYXJrZWREYXRlcy5pbmNsdWRlcyhpdGVtLmRhdGUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0Q2FsZW5kYXJzW2VdLndlZWtzW2ZdLmRheXNbaV0uaXNNYXJrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jYWxlbmRhci5kYXRlUmFuZ2Uuc3RhcnQuZGF0ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpdGVtRGF0ZSA9IGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdChpdGVtLmRhdGUpLmdldFRpbWUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdGhpc0RhdGUgPSBoZWxwQ2FsZW5kYXIuZ2V0RGF0ZUZyb21Gb3JtYXQoZGF0ZSkuZ2V0VGltZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGFydERhdGUgPSBoZWxwQ2FsZW5kYXIuZ2V0RGF0ZUZyb21Gb3JtYXQodGhpcy5jYWxlbmRhci5kYXRlUmFuZ2Uuc3RhcnQuZGF0ZSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdENhbGVuZGFyc1tlXS53ZWVrc1tmXS5kYXlzW2ldLmlzTW91c2VUb0xlZnQgPSAoaXRlbURhdGUgPT09IHN0YXJ0RGF0ZS5nZXRUaW1lKCkgJiYgdGhpc0RhdGUgPiBzdGFydERhdGUuZ2V0VGltZSgpKSB8fCAoaXRlbURhdGUgPT09IHRoaXNEYXRlICYmIHRoaXNEYXRlIDwgc3RhcnREYXRlLmdldFRpbWUoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0Q2FsZW5kYXJzW2VdLndlZWtzW2ZdLmRheXNbaV0uaXNNb3VzZVRvUmlnaHQgPSAoaXRlbURhdGUgPT09IHN0YXJ0RGF0ZS5nZXRUaW1lKCkgJiYgdGhpc0RhdGUgPCBzdGFydERhdGUuZ2V0VGltZSgpKSB8fCAoaXRlbURhdGUgPT09IHRoaXNEYXRlICYmIHRoaXNEYXRlID4gc3RhcnREYXRlLmdldFRpbWUoKSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkYXRlRGF5ID0gaGVscENhbGVuZGFyLmdldERhdGVGcm9tRm9ybWF0KGl0ZW0uZGF0ZSkuZ2V0RGF5KCkgLSAxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRlRGF5ID09PSAtMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlRGF5ID0gNjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkYXlPZldlZWtTdHJpbmcgPSB0aGlzLmZDb25maWdzLmRheU5hbWVzW2RhdGVEYXldOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5mQ29uZmlncy5kaXNhYmxlZERheU5hbWVzLmluY2x1ZGVzKGRheU9mV2Vla1N0cmluZykgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKChpdGVtRGF0ZSA+IHN0YXJ0RGF0ZS5nZXRUaW1lKCkgJiYgaXRlbURhdGUgPCB0aGlzRGF0ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoaXRlbURhdGUgPCBzdGFydERhdGUuZ2V0VGltZSgpICYmIGl0ZW1EYXRlID4gdGhpc0RhdGUpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RDYWxlbmRhcnNbZV0ud2Vla3NbZl0uZGF5c1tpXS5pc01hcmtlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY2FsZW5kYXIuZGF0ZVJhbmdlLmVuZC5kYXRlICYmIGl0ZW1EYXRlID09PSB0aGlzRGF0ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RDYWxlbmRhcnNbZV0ud2Vla3NbZl0uZGF5c1tpXS5pc0hvdmVyZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY2hlY2tTZWxEYXRlcygnbWluJywgdGhpcy5jYWxlbmRhci5kYXRlUmFuZ2Uuc3RhcnQuZGF0ZSwgaXRlbS5kYXRlLCBkYXRlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RDYWxlbmRhcnNbZV0ud2Vla3NbZl0uZGF5c1tpXS5pc01hcmtlZCA9IHRydWU7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWluRGF0ZVRvUmlnaHQsIG1pbkRhdGVUb0xlZnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbkRhdGVUb0xlZnQgPSBuZXcgRGF0ZShzdGFydERhdGUuZ2V0VGltZSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluRGF0ZVRvUmlnaHQgPSBuZXcgRGF0ZShzdGFydERhdGUuZ2V0VGltZSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluRGF0ZVRvTGVmdC5zZXREYXRlKG1pbkRhdGVUb0xlZnQuZ2V0RGF0ZSgpIC0gdGhpcy5mQ29uZmlncy5taW5TZWxEYXlzICsgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbkRhdGVUb1JpZ2h0LnNldERhdGUobWluRGF0ZVRvUmlnaHQuZ2V0RGF0ZSgpICsgdGhpcy5mQ29uZmlncy5taW5TZWxEYXlzIC0gMSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0RhdGUgPj0gbWluRGF0ZVRvTGVmdC5nZXRUaW1lKCkgJiYgaGVscENhbGVuZGFyLmZvcm1hdERhdGUobWluRGF0ZVRvTGVmdCkgPT09IGl0ZW0uZGF0ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0Q2FsZW5kYXJzW2VdLndlZWtzW2ZdLmRheXNbaV0uaXNNYXJrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdENhbGVuZGFyc1tlXS53ZWVrc1tmXS5kYXlzW2ldLmlzTW91c2VUb0xlZnQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0Q2FsZW5kYXJzW2VdLndlZWtzW2ZdLmRheXNbaV0uaXNIb3ZlcmVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzRGF0ZSA8PSBtaW5EYXRlVG9SaWdodC5nZXRUaW1lKCkgJiYgaGVscENhbGVuZGFyLmZvcm1hdERhdGUobWluRGF0ZVRvUmlnaHQpID09PSBpdGVtLmRhdGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdENhbGVuZGFyc1tlXS53ZWVrc1tmXS5kYXlzW2ldLmlzTWFya2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RDYWxlbmRhcnNbZV0ud2Vla3NbZl0uZGF5c1tpXS5pc01vdXNlVG9SaWdodCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RDYWxlbmRhcnNbZV0ud2Vla3NbZl0uZGF5c1tpXS5pc0hvdmVyZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGVja1NlbERhdGVzKCdtYXgnLCB0aGlzLmNhbGVuZGFyLmRhdGVSYW5nZS5zdGFydC5kYXRlLCBpdGVtLmRhdGUsIGRhdGUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdENhbGVuZGFyc1tlXS53ZWVrc1tmXS5kYXlzW2ldLmlzTWFya2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdENhbGVuZGFyc1tlXS53ZWVrc1tmXS5kYXlzW2ldLmlzSG92ZXJlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RDYWxlbmRhcnNbZV0ud2Vla3NbZl0uZGF5c1tpXS5pc01vdXNlVG9MZWZ0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdENhbGVuZGFyc1tlXS53ZWVrc1tmXS5kYXlzW2ldLmlzTW91c2VUb1JpZ2h0ID0gZmFsc2U7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWF4RGF0ZVRvTGVmdCwgbWF4RGF0ZVRvUmlnaHQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heERhdGVUb0xlZnQgPSBuZXcgRGF0ZShzdGFydERhdGUuZ2V0VGltZSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4RGF0ZVRvUmlnaHQgPSBuZXcgRGF0ZShzdGFydERhdGUuZ2V0VGltZSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4RGF0ZVRvTGVmdC5zZXREYXRlKG1heERhdGVUb0xlZnQuZ2V0RGF0ZSgpIC0gdGhpcy5mQ29uZmlncy5tYXhTZWxEYXlzICsgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heERhdGVUb1JpZ2h0LnNldERhdGUobWF4RGF0ZVRvUmlnaHQuZ2V0RGF0ZSgpICsgdGhpcy5mQ29uZmlncy5tYXhTZWxEYXlzIC0gMSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0RhdGUgPD0gbWF4RGF0ZVRvTGVmdC5nZXRUaW1lKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoZWxwQ2FsZW5kYXIuZm9ybWF0RGF0ZShtYXhEYXRlVG9MZWZ0KSA9PT0gaXRlbS5kYXRlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0Q2FsZW5kYXJzW2VdLndlZWtzW2ZdLmRheXNbaV0uaXNIb3ZlcmVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RDYWxlbmRhcnNbZV0ud2Vla3NbZl0uZGF5c1tpXS5pc01vdXNlVG9MZWZ0ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNEYXRlID49IG1heERhdGVUb1JpZ2h0LmdldFRpbWUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhlbHBDYWxlbmRhci5mb3JtYXREYXRlKG1heERhdGVUb1JpZ2h0KSA9PT0gaXRlbS5kYXRlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0Q2FsZW5kYXJzW2VdLndlZWtzW2ZdLmRheXNbaV0uaXNIb3ZlcmVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RDYWxlbmRhcnNbZV0ud2Vla3NbZl0uZGF5c1tpXS5pc01vdXNlVG9SaWdodCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICAvKioKICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufQogICAgICAgICAqLwogICAgICAgIFByZU1vbnRoKGNhbGVuZGFyS2V5ID0gbnVsbCkgewogICAgICAgICAgICBpZiAoIXRoaXMuYWxsb3dQcmVEYXRlKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgdGhpcy50cmFuc2l0aW9uUHJlZml4ID0gJ3JpZ2h0JzsKCiAgICAgICAgICAgIGNhbGVuZGFyS2V5ID0gY2FsZW5kYXJLZXkgIT09IG51bGwgPyBjYWxlbmRhcktleSA6IDA7CgogICAgICAgICAgICBsZXQgY3VycmVudENhbGVuZGFyID0gdGhpcy5saXN0Q2FsZW5kYXJzW2NhbGVuZGFyS2V5XTsKICAgICAgICAgICAgY3VycmVudENhbGVuZGFyLmRhdGUgPSBuZXcgRGF0ZShjdXJyZW50Q2FsZW5kYXIuZGF0ZS5nZXRGdWxsWWVhcigpLCBjdXJyZW50Q2FsZW5kYXIuZGF0ZS5nZXRNb250aCgpIC0gMSk7CiAgICAgICAgICAgIGN1cnJlbnRDYWxlbmRhci5rZXkgLT0gMTsKICAgICAgICAgICAgdGhpcy51cGRhdGVDYWxlbmRhcigpOwoKICAgICAgICAgICAgaWYgKCF0aGlzLmZDb25maWdzLmlzU2VwYXJhdGVseSkgewogICAgICAgICAgICAgICAgdGhpcy5jYWxlbmRhci5jdXJyZW50RGF0ZSA9IGN1cnJlbnRDYWxlbmRhci5kYXRlOwogICAgICAgICAgICAgICAgdGhpcy5pbml0Q2FsZW5kYXIoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy4kZW1pdCgnY2hhbmdlZE1vbnRoJywgY3VycmVudENhbGVuZGFyLmRhdGUpOwogICAgICAgIH0sCiAgICAgICAgLyoqCiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn0KICAgICAgICAgKi8KICAgICAgICBOZXh0TW9udGgoY2FsZW5kYXJLZXkgPSBudWxsKSB7CiAgICAgICAgICAgIGlmICghdGhpcy5hbGxvd05leHREYXRlKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgdGhpcy50cmFuc2l0aW9uUHJlZml4ID0gJ2xlZnQnOwoKICAgICAgICAgICAgY2FsZW5kYXJLZXkgPSBjYWxlbmRhcktleSAhPT0gbnVsbCA/IGNhbGVuZGFyS2V5IDogMDsKCiAgICAgICAgICAgIGxldCBjdXJyZW50Q2FsZW5kYXIgPSB0aGlzLmxpc3RDYWxlbmRhcnNbY2FsZW5kYXJLZXldOwogICAgICAgICAgICBjdXJyZW50Q2FsZW5kYXIuZGF0ZSA9IG5ldyBEYXRlKGN1cnJlbnRDYWxlbmRhci5kYXRlLmdldEZ1bGxZZWFyKCksIGN1cnJlbnRDYWxlbmRhci5kYXRlLmdldE1vbnRoKCkgKyAxKTsKICAgICAgICAgICAgY3VycmVudENhbGVuZGFyLmtleSArPSAxOwogICAgICAgICAgICB0aGlzLnVwZGF0ZUNhbGVuZGFyKCk7CgogICAgICAgICAgICBpZiAoIXRoaXMuZkNvbmZpZ3MuaXNTZXBhcmF0ZWx5KSB7CiAgICAgICAgICAgICAgICB0aGlzLmNhbGVuZGFyLmN1cnJlbnREYXRlID0gY3VycmVudENhbGVuZGFyLmRhdGU7CiAgICAgICAgICAgICAgICB0aGlzLmluaXRDYWxlbmRhcigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLiRlbWl0KCdjaGFuZ2VkTW9udGgnLCBjdXJyZW50Q2FsZW5kYXIuZGF0ZSk7CiAgICAgICAgfSwKICAgICAgICAvKioKICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufQogICAgICAgICAqLwogICAgICAgIFByZVllYXIoY2FsZW5kYXJLZXkgPSBudWxsKSB7CiAgICAgICAgICAgIGlmICghdGhpcy5hbGxvd1ByZURhdGUpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICBsZXQgc3RlcCA9IHRoaXMuc2hvd1llYXJQaWNrZXIgPyB0aGlzLmZDb25maWdzLmNoYW5nZVllYXJTdGVwIDogMTsKCiAgICAgICAgICAgIGNhbGVuZGFyS2V5ID0gY2FsZW5kYXJLZXkgIT09IG51bGwgPyBjYWxlbmRhcktleSA6IDA7CgogICAgICAgICAgICBsZXQgY3VycmVudENhbGVuZGFyID0gdGhpcy5saXN0Q2FsZW5kYXJzW2NhbGVuZGFyS2V5XTsKICAgICAgICAgICAgY3VycmVudENhbGVuZGFyLmRhdGUgPSBuZXcgRGF0ZShjdXJyZW50Q2FsZW5kYXIuZGF0ZS5nZXRGdWxsWWVhcigpIC0gc3RlcCwgY3VycmVudENhbGVuZGFyLmRhdGUuZ2V0TW9udGgoKSk7CiAgICAgICAgICAgIHRoaXMudXBkYXRlQ2FsZW5kYXIoKTsKCgogICAgICAgICAgICBpZiAoIXRoaXMuZkNvbmZpZ3MuaXNTZXBhcmF0ZWx5KSB7CiAgICAgICAgICAgICAgICB0aGlzLmNhbGVuZGFyLmN1cnJlbnREYXRlID0gY3VycmVudENhbGVuZGFyLmRhdGU7CiAgICAgICAgICAgICAgICB0aGlzLmluaXRDYWxlbmRhcigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLiRlbWl0KCdjaGFuZ2VkWWVhcicsIGN1cnJlbnRDYWxlbmRhci5kYXRlKTsKCiAgICAgICAgfSwKICAgICAgICAvKioKICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufQogICAgICAgICAqLwogICAgICAgIE5leHRZZWFyKGNhbGVuZGFyS2V5ID0gbnVsbCkgewogICAgICAgICAgICBpZiAoIXRoaXMuYWxsb3dOZXh0RGF0ZSkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAgIGxldCBzdGVwID0gdGhpcy5zaG93WWVhclBpY2tlciA/IHRoaXMuZkNvbmZpZ3MuY2hhbmdlWWVhclN0ZXAgOiAxOwoKICAgICAgICAgICAgY2FsZW5kYXJLZXkgPSBjYWxlbmRhcktleSAhPT0gbnVsbCA/IGNhbGVuZGFyS2V5IDogMDsKCiAgICAgICAgICAgIGxldCBjdXJyZW50Q2FsZW5kYXIgPSB0aGlzLmxpc3RDYWxlbmRhcnNbY2FsZW5kYXJLZXldOwogICAgICAgICAgICBjdXJyZW50Q2FsZW5kYXIuZGF0ZSA9IG5ldyBEYXRlKGN1cnJlbnRDYWxlbmRhci5kYXRlLmdldEZ1bGxZZWFyKCkgKyBzdGVwLCBjdXJyZW50Q2FsZW5kYXIuZGF0ZS5nZXRNb250aCgpKTsKICAgICAgICAgICAgdGhpcy51cGRhdGVDYWxlbmRhcigpOwoKICAgICAgICAgICAgaWYgKCF0aGlzLmZDb25maWdzLmlzU2VwYXJhdGVseSkgewogICAgICAgICAgICAgICAgdGhpcy5jYWxlbmRhci5jdXJyZW50RGF0ZSA9IGN1cnJlbnRDYWxlbmRhci5kYXRlOwogICAgICAgICAgICAgICAgdGhpcy5pbml0Q2FsZW5kYXIoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy4kZW1pdCgnY2hhbmdlZFllYXInLCBjdXJyZW50Q2FsZW5kYXIuZGF0ZSk7CiAgICAgICAgfSwKICAgICAgICBDaG9vc2VEYXRlKGRhdGUpIHsKICAgICAgICAgICAgbGV0IG5ld0RhdGUgPSBoZWxwQ2FsZW5kYXIuZ2V0RGF0ZUZyb21Gb3JtYXQoZGF0ZSk7CgogICAgICAgICAgICBpZiAoZGF0ZSA9PT0gJ3RvZGF5JykgewogICAgICAgICAgICAgICAgbmV3RGF0ZSA9IG5ldyBEYXRlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMubGlzdENhbGVuZGFyc1swXS5kYXRlID0gdGhpcy5jYWxlbmRhci5jdXJyZW50RGF0ZSA9IG5ld0RhdGU7CgogICAgICAgICAgICB0aGlzLnVwZGF0ZUNhbGVuZGFyKCk7CiAgICAgICAgICAgIHRoaXMuaW5pdENhbGVuZGFyKCk7CiAgICAgICAgfSwKICAgICAgICBvcGVuTW9udGhQaWNrZXIoa2V5KSB7CiAgICAgICAgICAgIGlmICh0aGlzLmZDb25maWdzLmNoYW5nZU1vbnRoRnVuY3Rpb24pIHsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd01vbnRoUGlja2VyID0gKGtleSA9PT0gdGhpcy5zaG93TW9udGhQaWNrZXIpID8gZmFsc2UgOiBrZXk7CiAgICAgICAgICAgICAgICB0aGlzLnNob3dZZWFyUGlja2VyID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIG9wZW5ZZWFyUGlja2VyKGtleSkgewogICAgICAgICAgICBpZiAodGhpcy5mQ29uZmlncy5jaGFuZ2VZZWFyRnVuY3Rpb24pIHsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd1llYXJQaWNrZXIgPSAoa2V5ID09PSB0aGlzLnNob3dZZWFyUGlja2VyKSA/IGZhbHNlIDoga2V5OwogICAgICAgICAgICAgICAgdGhpcy5zaG93TW9udGhQaWNrZXIgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgb3BlblRpbWVQaWNrZXIoKSB7CiAgICAgICAgICAgIHRoaXMuc2hvd1RpbWVQaWNrZXIgPSB0cnVlOwogICAgICAgIH0sCiAgICAgICAgcGlja01vbnRoKGtleSwgY2FsZW5kYXJLZXkpIHsKICAgICAgICAgICAgdGhpcy5zaG93TW9udGhQaWNrZXIgPSBmYWxzZTsKCiAgICAgICAgICAgIGxldCBjdXJyZW50Q2FsZW5kYXIgPSB0aGlzLmxpc3RDYWxlbmRhcnNbY2FsZW5kYXJLZXldOwogICAgICAgICAgICBsZXQgZGF0ZSA9IGN1cnJlbnRDYWxlbmRhci5kYXRlOwogICAgICAgICAgICBjdXJyZW50Q2FsZW5kYXIuZGF0ZSA9IG5ldyBEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSwga2V5ICsgMSwgMCk7CiAgICAgICAgICAgIHRoaXMudXBkYXRlQ2FsZW5kYXIoKTsKICAgICAgICB9LAogICAgICAgIHBpY2tZZWFyKHllYXIsIGNhbGVuZGFyS2V5KSB7CiAgICAgICAgICAgIHRoaXMuc2hvd1llYXJQaWNrZXIgPSBmYWxzZTsKCiAgICAgICAgICAgIGxldCBjdXJyZW50Q2FsZW5kYXIgPSB0aGlzLmxpc3RDYWxlbmRhcnNbY2FsZW5kYXJLZXldOwogICAgICAgICAgICBsZXQgZGF0ZSA9IGN1cnJlbnRDYWxlbmRhci5kYXRlOwogICAgICAgICAgICBjdXJyZW50Q2FsZW5kYXIuZGF0ZSA9IG5ldyBEYXRlKHllYXIsIGRhdGUuZ2V0TW9udGgoKSArIDEsIDApOwogICAgICAgICAgICB0aGlzLnVwZGF0ZUNhbGVuZGFyKCk7CiAgICAgICAgfSwKICAgICAgICBnZXRZZWFyTGlzdChkYXRlKSB7CiAgICAgICAgICAgIGxldCB5ZWFycyA9IFtdOwogICAgICAgICAgICBsZXQgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKSAtIDQ7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTI7IGkrKykgewogICAgICAgICAgICAgICAgbGV0IGZpbmFsWWVhciA9IHllYXIgKyBpOwoKICAgICAgICAgICAgICAgIHllYXJzLnB1c2goewogICAgICAgICAgICAgICAgICAgIHllYXI6IGZpbmFsWWVhcgogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHllYXJzOwogICAgICAgIH0sCiAgICAgICAgZ2V0Q2xhc3NOYW1lcyhkYXkpIHsKICAgICAgICAgICAgbGV0IGNsYXNzZXMgPSBbXTsKCiAgICAgICAgICAgIC8vIERpc2FibGUgZGF5cyBvZiB3ZWVrIGlmIHNldCBpbiBjb25maWd1cmF0aW9uCiAgICAgICAgICAgIGxldCBkYXRlRGF5ID0gaGVscENhbGVuZGFyLmdldERhdGVGcm9tRm9ybWF0KGRheS5kYXRlKS5nZXREYXkoKSAtIDE7CiAgICAgICAgICAgIGlmIChkYXRlRGF5ID09PSAtMSkgewogICAgICAgICAgICAgICAgZGF0ZURheSA9IDY7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IGRheU9mV2Vla1N0cmluZyA9IHRoaXMuZkNvbmZpZ3MuZGF5TmFtZXNbZGF0ZURheV07CiAgICAgICAgICAgIGlmICh0aGlzLmZDb25maWdzLmRpc2FibGVkRGF5TmFtZXMuaW5jbHVkZXMoZGF5T2ZXZWVrU3RyaW5nKSkgewogICAgICAgICAgICAgICAgZGF5LmhpZGUgPSB0cnVlOwogICAgICAgICAgICAgICAgY2xhc3Nlcy5wdXNoKCd2ZmMtY3Vyc29yLW5vdC1hbGxvd2VkJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCBkYXRlID0gaGVscENhbGVuZGFyLmdldERhdGVGcm9tRm9ybWF0KGRheS5kYXRlKTsKICAgICAgICAgICAgbGV0IHRvZGF5ID0gbmV3IERhdGUoKTsKICAgICAgICAgICAgdG9kYXkuc2V0SG91cnMoMCwgMCwgMCwgMCk7CgoKICAgICAgICAgICAgLy8gRGlzYWJsZWQgZGF0ZXMKICAgICAgICAgICAgaWYgKHRoaXMuaXNEaXNhYmxlZERhdGUoZGF5LmRhdGUpKSB7CiAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goJ3ZmYy1kaXNhYmxlZCcpOwogICAgICAgICAgICAgICAgY2xhc3Nlcy5wdXNoKCd2ZmMtY3Vyc29yLW5vdC1hbGxvd2VkJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLmZDb25maWdzLmxpbWl0cykgewogICAgICAgICAgICAgICAgbGV0IG1pbiA9IGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdCh0aGlzLmZDb25maWdzLmxpbWl0cy5taW4pLmdldFRpbWUoKTsKICAgICAgICAgICAgICAgIGxldCBtYXggPSBoZWxwQ2FsZW5kYXIuZ2V0RGF0ZUZyb21Gb3JtYXQodGhpcy5mQ29uZmlncy5saW1pdHMubWF4KS5nZXRUaW1lKCk7CgogICAgICAgICAgICAgICAgaWYgKGRhdGUuZ2V0VGltZSgpIDwgbWluIHx8IGRhdGUuZ2V0VGltZSgpID4gbWF4KSB7CiAgICAgICAgICAgICAgICAgICAgY2xhc3Nlcy5wdXNoKCd2ZmMtZGlzYWJsZWQnKTsKICAgICAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goJ3ZmYy1jdXJzb3Itbm90LWFsbG93ZWQnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGRheS5oaWRlKSB7CiAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goJ3ZmYy1oaWRlJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFRvZGF5IGRhdGUKICAgICAgICAgICAgaWYgKGRheS5pc1RvZGF5KSB7CiAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goJ3ZmYy10b2RheScpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIWRheS5oaWRlTGVmdEFuZFJpZ2h0RGF5cyAmJiAhdGhpcy5mQ29uZmlncy5kaXNhYmxlZERheU5hbWVzLmluY2x1ZGVzKGRheU9mV2Vla1N0cmluZykpIHsKCiAgICAgICAgICAgICAgICAvLyBNYXJrIERhdGUKICAgICAgICAgICAgICAgIGlmIChkYXkuaXNNYXJrZWQpIHsKICAgICAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goJ3ZmYy1tYXJrZWQnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF5LmlzSG92ZXJlZCkgewogICAgICAgICAgICAgICAgICAgIGNsYXNzZXMucHVzaCgndmZjLWhvdmVyZWQnKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAodGhpcy5mQ29uZmlncy5tYXJrZWREYXRlcy5pbmNsdWRlcyhkYXkuZGF0ZSkpIHsKICAgICAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goJ3ZmYy1ib3JkZXJkJyk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5mQ29uZmlncy5tYXJrZWREYXRlUmFuZ2UpKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mQ29uZmlncy5tYXJrZWREYXRlUmFuZ2UuZm9yRWFjaChyYW5nZSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoZWxwQ2FsZW5kYXIuZ2V0RGF0ZUZyb21Gb3JtYXQocmFuZ2Uuc3RhcnQpIDw9IGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdChkYXkuZGF0ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdChyYW5nZS5lbmQpID49IGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdChkYXkuZGF0ZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXMucHVzaCgndmZjLW1hcmtlZCcpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF5LmRhdGUgPT09IHJhbmdlLnN0YXJ0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goJ3ZmYy1zdGFydC1tYXJrZWQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXkuZGF0ZSA9PT0gcmFuZ2UuZW5kKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goJ3ZmYy1lbmQtbWFya2VkJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmZDb25maWdzLm1hcmtlZERhdGVSYW5nZS5zdGFydCAmJiB0aGlzLmZDb25maWdzLm1hcmtlZERhdGVSYW5nZS5lbmQpIHsKICAgICAgICAgICAgICAgICAgICAvLyBEYXRlIFJhbmdlIE1hcmtlZAogICAgICAgICAgICAgICAgICAgIGlmIChoZWxwQ2FsZW5kYXIuZ2V0RGF0ZUZyb21Gb3JtYXQodGhpcy5mQ29uZmlncy5tYXJrZWREYXRlUmFuZ2Uuc3RhcnQpIDw9IGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdChkYXkuZGF0ZSkKICAgICAgICAgICAgICAgICAgICAgICAgJiYgaGVscENhbGVuZGFyLmdldERhdGVGcm9tRm9ybWF0KHRoaXMuZkNvbmZpZ3MubWFya2VkRGF0ZVJhbmdlLmVuZCkgPj0gaGVscENhbGVuZGFyLmdldERhdGVGcm9tRm9ybWF0KGRheS5kYXRlKSkgewogICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goJ3ZmYy1tYXJrZWQnKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmIChkYXkuZGF0ZSA9PT0gdGhpcy5mQ29uZmlncy5tYXJrZWREYXRlUmFuZ2Uuc3RhcnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3Nlcy5wdXNoKCd2ZmMtc3RhcnQtbWFya2VkJyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXkuZGF0ZSA9PT0gdGhpcy5mQ29uZmlncy5tYXJrZWREYXRlUmFuZ2UuZW5kKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXMucHVzaCgndmZjLWVuZC1tYXJrZWQnKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgQWZ0ZXIgU3RhcnQgTWFya2VkCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZkNvbmZpZ3MubWFya2VkRGF0ZVJhbmdlLnN0YXJ0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoZWxwQ2FsZW5kYXIuZ2V0RGF0ZUZyb21Gb3JtYXQodGhpcy5mQ29uZmlncy5tYXJrZWREYXRlUmFuZ2Uuc3RhcnQpIDw9IGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdChkYXkuZGF0ZSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goJ3ZmYy1tYXJrZWQnKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgQmVmb3JlIEVuZCBNYXJrZWQKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5mQ29uZmlncy5tYXJrZWREYXRlUmFuZ2UuZW5kKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoZWxwQ2FsZW5kYXIuZ2V0RGF0ZUZyb21Gb3JtYXQodGhpcy5mQ29uZmlncy5tYXJrZWREYXRlUmFuZ2UuZW5kKSA+PSBoZWxwQ2FsZW5kYXIuZ2V0RGF0ZUZyb21Gb3JtYXQoZGF5LmRhdGUpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3Nlcy5wdXNoKCd2ZmMtbWFya2VkJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNsYXNzZXMucHVzaCgndmZjLWhvdmVyJyk7CiAgICAgICAgICAgIH0KCgogICAgICAgICAgICAvLyBEYXRlIE1hcmsgV2l0aCBDdXN0b20gQ2xhc3NlcwogICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuZkNvbmZpZ3MubWFya2VkRGF0ZXMgPT09ICJvYmplY3QiKSB7CiAgICAgICAgICAgICAgICBsZXQgY2hlY2tNYXJrZWQgPSB0aGlzLmZDb25maWdzLm1hcmtlZERhdGVzLmZpbmQoZnVuY3Rpb24gKG1hcmtEYXRlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hcmtEYXRlLmRhdGUgPT09IGRheS5kYXRlOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjaGVja01hcmtlZCAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goY2hlY2tNYXJrZWQuY2xhc3MpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZGF5LmRhdGUgPT09IHRoaXMuY2FsZW5kYXIuZGF0ZVJhbmdlLnN0YXJ0LmRhdGUpIHsKICAgICAgICAgICAgICAgIGNsYXNzZXMucHVzaCgndmZjLXN0YXJ0LW1hcmtlZCcpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZGF5LmRhdGUgPT09IHRoaXMuY2FsZW5kYXIuZGF0ZVJhbmdlLmVuZC5kYXRlKSB7CiAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goJ3ZmYy1lbmQtbWFya2VkJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChkYXkuZGF0ZSA9PT0gdGhpcy5jYWxlbmRhci5zZWxlY3RlZERhdGUgfHwgdGhpcy5jYWxlbmRhci5zZWxlY3RlZERhdGVzLmZpbmQoc0RhdGUgPT4gc0RhdGUuZGF0ZSA9PT0gZGF5LmRhdGUpKSB7CiAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goJ3ZmYy1ib3JkZXJkJykKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIGNsYXNzZXM7CiAgICAgICAgfSwKICAgICAgICBjaGVja0RhdGVSYW5nZVN0YXJ0KGRhdGUpIHsKICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5mQ29uZmlncy5tYXJrZWREYXRlUmFuZ2UpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mQ29uZmlncy5tYXJrZWREYXRlUmFuZ2UuZmluZEluZGV4KHJhbmdlID0+IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmFuZ2Uuc3RhcnQgPT09IGRhdGU7CiAgICAgICAgICAgICAgICB9KSAhPT0gLTE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBkYXRlID09PSB0aGlzLmZDb25maWdzLm1hcmtlZERhdGVSYW5nZS5zdGFydDsKICAgICAgICB9LAogICAgICAgIGNoZWNrRGF0ZVJhbmdlRW5kKGRhdGUpIHsKICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5mQ29uZmlncy5tYXJrZWREYXRlUmFuZ2UpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mQ29uZmlncy5tYXJrZWREYXRlUmFuZ2UuZmluZEluZGV4KHJhbmdlID0+IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmFuZ2UuZW5kID09PSBkYXRlOwogICAgICAgICAgICAgICAgfSkgIT09IC0xOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gZGF0ZSA9PT0gdGhpcy5mQ29uZmlncy5tYXJrZWREYXRlUmFuZ2UuZW5kOwogICAgICAgIH0sCiAgICAgICAgY2hlY2tTZWxEYXRlcyh0eXBlLCBzdGFydERhdGUsIGl0ZW1EYXRlLCBob3ZlckRhdGUpIHsKICAgICAgICAgICAgbGV0IHN0YXJ0VGltZSA9IGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdChzdGFydERhdGUpLmdldFRpbWUoKTsKICAgICAgICAgICAgbGV0IGl0ZW1UaW1lID0gaGVscENhbGVuZGFyLmdldERhdGVGcm9tRm9ybWF0KGl0ZW1EYXRlKS5nZXRUaW1lKCk7CiAgICAgICAgICAgIGxldCBob3ZlclRpbWUgPSBoZWxwQ2FsZW5kYXIuZ2V0RGF0ZUZyb21Gb3JtYXQoaG92ZXJEYXRlKS5nZXRUaW1lKCk7CgogICAgICAgICAgICBsZXQgZGF5cyA9IHR5cGUgPT09ICdtaW4nID8gdGhpcy5mQ29uZmlncy5taW5TZWxEYXlzIDogdGhpcy5mQ29uZmlncy5tYXhTZWxEYXlzIC0gMjsKICAgICAgICAgICAgbGV0IG1pblRpbWUgPSBkYXlzICogMTAwMCAqIDYwICogNjAgKiAyNDsKICAgICAgICAgICAgbGV0IHJpZ2h0VGltZSA9IHN0YXJ0VGltZSArIG1pblRpbWU7CiAgICAgICAgICAgIGxldCBsZWZ0VGltZSA9IHN0YXJ0VGltZSAtIG1pblRpbWU7CgogICAgICAgICAgICBsZXQgcmVzdWx0OwogICAgICAgICAgICBpZiAoaG92ZXJUaW1lID4gc3RhcnRUaW1lKSB7CiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ21pbicpCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gaXRlbVRpbWUgPCByaWdodFRpbWUgJiYgaXRlbVRpbWUgPiBzdGFydFRpbWUgJiYgdGhpcy5mQ29uZmlncy5taW5TZWxEYXlzOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGl0ZW1UaW1lID4gcmlnaHRUaW1lICYmIGl0ZW1UaW1lID4gc3RhcnRUaW1lICYmIHRoaXMuZkNvbmZpZ3MubWF4U2VsRGF5czsKICAgICAgICAgICAgfSBlbHNlIGlmIChob3ZlclRpbWUgPCBzdGFydFRpbWUpIHsKICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAnbWluJykKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBpdGVtVGltZSA+IGxlZnRUaW1lICYmIGl0ZW1UaW1lIDwgc3RhcnRUaW1lICYmIHRoaXMuZkNvbmZpZ3MubWluU2VsRGF5czsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBpdGVtVGltZSA8IGxlZnRUaW1lICYmIGl0ZW1UaW1lIDwgc3RhcnRUaW1lICYmIHRoaXMuZkNvbmZpZ3MubWF4U2VsRGF5czsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgICB9LAogICAgICAgIGNoZWNrTGltaXRzKHZhbHVlKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmZDb25maWdzLmxpbWl0cykgewogICAgICAgICAgICAgICAgbGV0IG1pbiA9IG5ldyBEYXRlKGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdCh0aGlzLmZDb25maWdzLmxpbWl0cy5taW4pKTsKICAgICAgICAgICAgICAgIG1pbi5zZXREYXRlKDEpOwogICAgICAgICAgICAgICAgbWluLnNldEhvdXJzKDAsIDAsIDAsIDApOwogICAgICAgICAgICAgICAgbGV0IG1heCA9IG5ldyBEYXRlKGhlbHBDYWxlbmRhci5nZXREYXRlRnJvbUZvcm1hdCh0aGlzLmZDb25maWdzLmxpbWl0cy5tYXgpKTsKICAgICAgICAgICAgICAgIG1heC5zZXREYXRlKDEpOwogICAgICAgICAgICAgICAgbWF4LnNldEhvdXJzKDAsIDAsIDAsIDApOwoKICAgICAgICAgICAgICAgIHRoaXMuYWxsb3dQcmVEYXRlID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHRoaXMuYWxsb3dOZXh0RGF0ZSA9IHRydWU7CgogICAgICAgICAgICAgICAgbGV0IGN1cnJlbnQgPSBuZXcgRGF0ZSh2YWx1ZSk7CiAgICAgICAgICAgICAgICBjdXJyZW50LnNldERhdGUoMSk7CiAgICAgICAgICAgICAgICBjdXJyZW50LnNldEhvdXJzKDAsIDAsIDAsIDApOwoKICAgICAgICAgICAgICAgIGlmIChjdXJyZW50IDw9IG1pbikgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsb3dQcmVEYXRlID0gZmFsc2U7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQgPj0gbWF4KSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbGxvd05leHREYXRlID0gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGdldFRyYW5zaXRpb25fKCkgewogICAgICAgICAgICBpZiAoIXRoaXMuZkNvbmZpZ3MudHJhbnNpdGlvbikKICAgICAgICAgICAgICAgIHJldHVybiAnJzsKCiAgICAgICAgICAgIGxldCBuYW1lID0gJyc7CiAgICAgICAgICAgIGlmICh0aGlzLnRyYW5zaXRpb25QcmVmaXggPT09ICdsZWZ0JykgewogICAgICAgICAgICAgICAgbmFtZSA9ICd2ZmMtY2FsZW5kYXItc2xpZGUtbGVmdCc7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy50cmFuc2l0aW9uUHJlZml4ID09PSAncmlnaHQnKSB7CiAgICAgICAgICAgICAgICBuYW1lID0gJ3ZmYy1jYWxlbmRhci1zbGlkZS1yaWdodCc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIG5hbWU7CiAgICAgICAgfSwKICAgICAgICBzZXRDYWxlbmRhclN0eWxlcygpIHsKICAgICAgICAgICAgbGV0IGRheSA9IHRoaXMuJHJlZnMuZGF5WzBdOwogICAgICAgICAgICBsZXQgY29udGFpbmVyID0gdGhpcy4kcmVmcy5tYWluQ29udGFpbmVyOwoKICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAiIjsKICAgICAgICAgICAgbGV0IGhlaWdodCA9IGNvbnRhaW5lci5jbGllbnRIZWlnaHQgKyAoZGF5LmNsaWVudEhlaWdodCArIChkYXkuY2xpZW50SGVpZ2h0IC8gMi41KSk7CiAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyAicHgiOwoKICAgICAgICAgICAgaWYgKHRoaXMuZkNvbmZpZ3MuaXNNb2RhbCkgewogICAgICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAibm9uZSIKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgY2hlY2tIaWRkZW5FbGVtZW50KGVsZW1lbnROYW1lKSB7CiAgICAgICAgICAgIHJldHVybiAhdGhpcy5mQ29uZmlncy5oaWRkZW5FbGVtZW50cy5pbmNsdWRlcyhlbGVtZW50TmFtZSk7CiAgICAgICAgfSwKICAgICAgICBjYW5DYWxlbmRhckNsb3NlZChlKSB7CiAgICAgICAgICAgIGlmICghdGhpcy4kZWwuY29udGFpbnMoZS50YXJnZXQpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zaG93Q2FsZW5kYXIgPSBmYWxzZQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0sCiAgICAgICAgaXNEaXNhYmxlZERhdGUoZGF0ZSkgewogICAgICAgICAgICBsZXQgdG9kYXkgPSBuZXcgRGF0ZSgpOwogICAgICAgICAgICB0b2RheS5zZXRIb3VycygwLCAwLCAwLCAwKTsKICAgICAgICAgICAgbGV0IGRhdGVPYmogPSBoZWxwQ2FsZW5kYXIuZ2V0RGF0ZUZyb21Gb3JtYXQoZGF0ZSk7CgogICAgICAgICAgICByZXR1cm4gdGhpcy5mQ29uZmlncy5kaXNhYmxlZERhdGVzLmluY2x1ZGVzKGRhdGUpIHx8CiAgICAgICAgICAgICAgICAodGhpcy5mQ29uZmlncy5kaXNhYmxlZERhdGVzLmluY2x1ZGVzKCdiZWZvcmVUb2RheScpICYmIGRhdGVPYmouZ2V0VGltZSgpIDwgdG9kYXkuZ2V0VGltZSgpKSB8fAogICAgICAgICAgICAgICAgKHRoaXMuZkNvbmZpZ3MuZGlzYWJsZWREYXRlcy5pbmNsdWRlcygnYWZ0ZXJUb2RheScpICYmIGRhdGVPYmouZ2V0VGltZSgpID4gdG9kYXkuZ2V0VGltZSgpKQogICAgICAgIH0sCiAgICAgICAgaGlkZU1vbnRoWWVhclBpY2tlcihlKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnNob3dNb250aFBpY2tlciB8fCB0aGlzLnNob3dZZWFyUGlja2VyKSB7CiAgICAgICAgICAgICAgICBsZXQga2V5ID0gdGhpcy5zaG93TW9udGhQaWNrZXIgPyB0aGlzLnNob3dNb250aFBpY2tlciAtIDEgOiB0aGlzLnNob3dZZWFyUGlja2VyIC0gMTsKCiAgICAgICAgICAgICAgICBsZXQgZWxlbWVudDEgPSB0aGlzLiRyZWZzLmNhbGVuZGFycy5xdWVyeVNlbGVjdG9yKGAudmZjLWNhbGVuZGFycyAudmZjLWNhbGVuZGFyOm50aC1jaGlsZCgke2tleSArIDF9KSAudmZjLXRvcC1kYXRlIGE6bnRoLWNoaWxkKDEpYCk7CiAgICAgICAgICAgICAgICBsZXQgZWxlbWVudDIgPSB0aGlzLiRyZWZzLmNhbGVuZGFycy5xdWVyeVNlbGVjdG9yKGAudmZjLWNhbGVuZGFycyAudmZjLWNhbGVuZGFyOm50aC1jaGlsZCgke2tleSArIDF9KSAudmZjLXRvcC1kYXRlIGE6bnRoLWNoaWxkKDIpYCk7CgogICAgICAgICAgICAgICAgaWYgKCF0aGlzLiRyZWZzLm1vbnRoQ29udGFpbmVyW2tleV0uJGVsLmNvbnRhaW5zKGUudGFyZ2V0KSAmJiAhZWxlbWVudDEuY29udGFpbnMoZS50YXJnZXQpICYmICFlbGVtZW50Mi5jb250YWlucyhlLnRhcmdldCkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zaG93TW9udGhQaWNrZXIgPSB0aGlzLnNob3dZZWFyUGlja2VyID0gZmFsc2UKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQo="},{"version":3,"sources":["FunctionalCalendar.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2GA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"FunctionalCalendar.vue","sourceRoot":"node_modules/vue-functional-calendar/src/components","sourcesContent":["<template>\r\n    <div :class=\"{'vfc-styles-conditional-class': fConfigs.applyStylesheet}\">\r\n        <div class=\"vfc-multiple-input\" :class=\"{'vfc-dark': fConfigs.isDark}\"\r\n             v-if=\"fConfigs.isModal && fConfigs.isDateRange\">\r\n            <input type=\"text\" title=\"Start Date\"\r\n                   v-model=\"input.dateRange.start.date\"\r\n                   :placeholder=\"fConfigs.placeholder\"\r\n                   :readonly=\"!fConfigs.isTypeable\"\r\n                   :maxlength=\"fConfigs.dateFormat.length\"\r\n                   @click=\"showCalendar = !showCalendar\">\r\n            <input type=\"text\" title=\"End Date\"\r\n                   v-model=\"input.dateRange.end.date\"\r\n                   :placeholder=\"fConfigs.placeholder\"\r\n                   :readonly=\"!fConfigs.isTypeable\"\r\n                   :maxlength=\"fConfigs.dateFormat.length\"\r\n                   @click=\"showCalendar = !showCalendar\">\r\n        </div>\r\n        <div :class=\"{'vfc-dark': fConfigs.isDark}\" v-else-if=\"fConfigs.isModal && fConfigs.isDatePicker\">\r\n            <input class=\"vfc-single-input\" type=\"text\" title=\"Date\"\r\n                   v-model=\"input.selectedDate\"\r\n                   :placeholder=\"fConfigs.placeholder\"\r\n                   :readonly=\"!fConfigs.isTypeable\"\r\n                   :maxlength=\"fConfigs.dateFormat.length\"\r\n                   @click=\"showCalendar = !showCalendar\">\r\n        </div>\r\n\r\n        <div class=\"vfc-main-container\" v-show=\"showCalendar\"\r\n             ref=\"mainContainer\"\r\n             :class=\"{'vfc-modal': fConfigs.isModal && (fConfigs.isDatePicker || fConfigs.isDateRange), 'vfc-dark': fConfigs.isDark}\">\r\n            <time-picker v-if=\"showTimePicker\"></time-picker>\r\n            <template v-else>\r\n                <div class=\"vfc-calendars-container\">\r\n                    <div class=\"vfc-calendars\" ref=\"calendars\">\r\n                        <div class=\"vfc-calendar\" v-for=\"(calendarItem, key) in listCalendars\" :key=\"calendarItem.key\">\r\n                            <month-year-picker ref=\"monthContainer\"\r\n                                               v-show=\"showMonthPicker === key+1 || showYearPicker === key+1\"\r\n                                               :calendar-key=\"key\">\r\n                            </month-year-picker>\r\n                            <div class=\"vfc-content\">\r\n                                <div class=\"vfc-separately-navigation-buttons\"\r\n                                     v-if=\"(!fConfigs.isSeparately && key === 0) || fConfigs.isSeparately\">\r\n                                    <div @click=\"PreMonth(key)\" :class=\"{'vfc-cursor-pointer': allowPreDate}\">\r\n                                        <div class=\"vfc-arrow-left\" :class=\"{'vfc-disabled': !allowPreDate}\"></div>\r\n                                    </div>\r\n                                    <div @click=\"NextMonth(key)\" :class=\"{'vfc-cursor-pointer': allowNextDate}\">\r\n                                        <div class=\"vfc-arrow-right\" :class=\"{'vfc-disabled': !allowNextDate}\"></div>\r\n                                    </div>\r\n                                </div>\r\n                                <h2 class=\"vfc-top-date\"\r\n                                    v-if=\"checkHiddenElement('month')\">\r\n                                    <a href=\"#\" @click.prevent=\"openMonthPicker(key+1)\"\r\n                                       :class=\"{'vfc-cursor-pointer vfc-underline':fConfigs.changeMonthFunction, 'vfc-underline-active':showMonthPicker === key+1}\">\r\n                                        {{ calendarItem.month }}</a>\r\n                                    <a href=\"#\" @click.prevent=\"openYearPicker(key+1)\"\r\n                                       :class=\"{'vfc-cursor-pointer vfc-underline':fConfigs.changeYearFunction,  'vfc-underline-active':showYearPicker === key+1}\">\r\n                                        {{ calendarItem.year }}\r\n                                    </a>\r\n                                </h2>\r\n                                <section class=\"vfc-dayNames\">\r\n                                    <span v-if=\"fConfigs.showWeekNumbers\"></span>\r\n                                    <span v-for=\"(dayName, key) in fConfigs.dayNames\" :key=\"key\">\r\n                                        <template v-if=\"checkHiddenElement('dayNames')\">\r\n                                            {{ dayName }}\r\n                                        </template>\r\n                                    </span>\r\n                                </section>\r\n                                <transition-group\r\n                                        tag='div'\r\n                                        :name='getTransition_()' appear>\r\n                                    <div class=\"vfc-week\" v-for=\"(week, week_key) in calendarItem.weeks\"\r\n                                         :key=\"week_key+0\">\r\n                                        <div v-if=\"fConfigs.showWeekNumbers\" class=\"vfc-day vfc-week-number\">\r\n                                            <span class=\"vfc-span-day\">\r\n                                                {{ week.number }}\r\n                                            </span>\r\n                                        </div>\r\n                                        <div class=\"vfc-day\" ref=\"day\" v-for=\"(day, day_key) in week.days\"\r\n                                             :key=\"day_key\">\r\n                                            <div v-if=\"(day.isDateRangeStart || day.isMouseToLeft) && !day.hideLeftAndRightDays\"\r\n                                                 class=\"vfc-base-start\">\r\n                                            </div>\r\n                                            <div v-else-if=\"(day.isDateRangeEnd || day.isMouseToRight) && !day.hideLeftAndRightDays\"\r\n                                                 class=\"vfc-base-end\">\r\n                                            </div>\r\n                                            <span v-if=\"!day.hideLeftAndRightDays\"\r\n                                                  data-date=\"\" :key=\"day_key\"\r\n                                                  class=\"vfc-span-day\"\r\n                                                  :class=\"getClassNames(day)\"\r\n                                                  @click=\"clickDay(day)\"\r\n                                                  @mouseover=\"dayMouseOver(week_key, day.date)\">\r\n                                                <slot :week=\"week\" :day=\"day\">\r\n                                                    {{ day.day }}\r\n                                                </slot>\r\n                                        </span>\r\n                                        </div>\r\n                                    </div>\r\n                                </transition-group>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </template>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import helpCalendar from '../assets/js/calendar'\r\n    import {propsAndData} from \"../mixins/propsAndData\";\r\n    import TimePicker from \"./TimePicker\";\r\n    import MonthYearPicker from \"./MonthYearPicker\";\r\n\r\n    export default {\r\n        name: \"FunctionalCalendar\",\r\n        components: {MonthYearPicker, TimePicker},\r\n        mixins: [propsAndData],\r\n        created() {\r\n            this.setConfigs();\r\n            this.initCalendar();\r\n        },\r\n        mounted() {\r\n            if (this.fConfigs.isModal && !this.fConfigs.withTimePicker) {\r\n                // Event\r\n                window.addEventListener('click', this.canCalendarClosed);\r\n            }\r\n\r\n            window.addEventListener('click', this.hideMonthYearPicker);\r\n            window.addEventListener('resize', this.setCalendarStyles);\r\n\r\n            // Reacts to external selected dates\r\n            this.$watch('value', function (value) {\r\n                if (this.fConfigs.isDateRange) {\r\n                    this.calendar.dateRange.start.date = value.dateRange.start.date || false;\r\n                    this.calendar.dateRange.end.date = value.dateRange.end.date || false\r\n                } else {\r\n                    this.calendar.selectedDate = value.selectedDate || false\r\n                }\r\n            }, {deep: true});\r\n\r\n            this.$watch('showCalendar', function (value) {\r\n                if (value)\r\n                    this.$emit('opened');\r\n                else\r\n                    this.$emit('closed');\r\n            }, {immediate: true, deep: true});\r\n\r\n            this.setCalendarStyles();\r\n        },\r\n        beforeDestroy: function () {\r\n            window.removeEventListener('click', this.canCalendarClosed);\r\n            window.removeEventListener('click', this.hideMonthYearPicker);\r\n            window.removeEventListener('resize', this.setCalendarStyles);\r\n        },\r\n        watch: {\r\n            'fConfigs.markedDates': {\r\n                handler() {\r\n                    this.markChooseDays();\r\n                }\r\n            },\r\n            'fConfigs.markedDateRange': {\r\n                handler() {\r\n                    this.markChooseDays();\r\n                }\r\n            },\r\n            'calendar.selectedDate': {\r\n                handler(val) {\r\n                    this.input.selectedDate = val || '';\r\n                    this.markChooseDays();\r\n                }\r\n            },\r\n            'calendar.currentDate': {\r\n                handler(value) {\r\n                    this.$emit('input', this.calendar);\r\n                    this.checkLimits(value);\r\n                }\r\n            },\r\n            'calendar.dateRange.start.date': {\r\n                handler(val) {\r\n                    this.input.dateRange.start.date = val || '';\r\n                    this.markChooseDays();\r\n                }\r\n            },\r\n            'calendar.dateRange.end.date': {\r\n                handler(val) {\r\n                    this.input.dateRange.end.date = val || '';\r\n                    this.markChooseDays();\r\n                }\r\n            },\r\n            'input.selectedDate': {\r\n                handler(val) {\r\n                    this.input.selectedDate = val = helpCalendar.mask(val);\r\n                    if (helpCalendar.getDateFromFormat(val).getMonth()) {\r\n                        this.calendar.selectedDate = val;\r\n                        this.markChooseDays();\r\n                    }\r\n\r\n                    // Typeable\r\n                    if (helpCalendar.checkValidDate(val) && this.fConfigs.isTypeable) {\r\n                        this.ChooseDate(val);\r\n                    }\r\n                }\r\n            },\r\n            'input.dateRange.start.date': {\r\n                handler(val) {\r\n                    this.input.dateRange.start.date = val = helpCalendar.mask(val);\r\n                    if (helpCalendar.getDateFromFormat(val).getMonth()) {\r\n                        this.calendar.dateRange.start.date = val;\r\n                        this.markChooseDays();\r\n                    }\r\n\r\n                    // Typeable\r\n                    if (helpCalendar.checkValidDate(val) && this.fConfigs.isTypeable) {\r\n                        this.ChooseDate(val);\r\n                    }\r\n                }\r\n            },\r\n            'input.dateRange.end.date': {\r\n                handler(val) {\r\n                    this.input.dateRange.end.date = val = helpCalendar.mask(val);\r\n                    if (helpCalendar.getDateFromFormat(val).getMonth()) {\r\n                        this.calendar.dateRange.end.date = val;\r\n                        this.markChooseDays();\r\n                    }\r\n\r\n                    // Typeable\r\n                    if (helpCalendar.checkValidDate(val) && this.fConfigs.isTypeable) {\r\n                        this.ChooseDate(val);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        methods: {\r\n            initCalendar() {\r\n                // Set Help Calendar Configs\r\n                helpCalendar.configs.sundayStart = this.fConfigs.sundayStart;\r\n                helpCalendar.configs.leftAndRightDays = this.checkHiddenElement('leftAndRightDays');\r\n                helpCalendar.configs.dateFormat = this.fConfigs.dateFormat;\r\n                helpCalendar.configs.dayNames = this.fConfigs.dayNames;\r\n                helpCalendar.configs.monthNames = this.fConfigs.monthNames;\r\n\r\n                this.setCalendarData();\r\n                this.listRendering();\r\n                this.markChooseDays();\r\n                this.checkLimits(this.calendar.currentDate);\r\n            },\r\n            updateCalendar() {\r\n                this.setExistingCalendarData();\r\n                this.listRendering();\r\n                this.markChooseDays();\r\n            },\r\n            setCalendarData() {\r\n                let date = this.calendar.currentDate;\r\n                date = new Date(date.getFullYear(), date.getMonth() - 1);\r\n\r\n                this.listCalendars = [];\r\n\r\n                for (let i = 0; i < this.fConfigs.calendarsCount; i++) {\r\n                    date = new Date(date.getFullYear(), date.getMonth() + 1);\r\n\r\n                    let calendar = {\r\n                        key: i,\r\n                        date: date,\r\n                        dateTop: `${this.fConfigs.monthNames[date.getMonth()]} ${date.getFullYear()}`,\r\n                        month: this.fConfigs.monthNames[date.getMonth()],\r\n                        year: date.getFullYear(),\r\n                        weeks: helpCalendar.getFinalizedWeeks(date.getMonth(), date.getFullYear())\r\n                    };\r\n\r\n                    this.listCalendars.push(calendar);\r\n\r\n                    if (!this.fConfigs.isMultiple) {\r\n                        break;\r\n                    }\r\n                }\r\n            },\r\n            setExistingCalendarData() {\r\n                for (let i = 0; i < this.listCalendars.length; i++) {\r\n                    let calendar = this.listCalendars[i];\r\n                    let date = calendar.date;\r\n\r\n                    this.$set(this.listCalendars, i, {\r\n                        key: calendar.key,\r\n                        date: date,\r\n                        dateTop: `${this.fConfigs.monthNames[date.getMonth()]} ${date.getFullYear()}`,\r\n                        month: this.fConfigs.monthNames[date.getMonth()],\r\n                        year: date.getFullYear(),\r\n                        weeks: helpCalendar.getFinalizedWeeks(date.getMonth(), date.getFullYear())\r\n                    });\r\n\r\n                    if (!this.fConfigs.isMultiple) {\r\n                        break;\r\n                    }\r\n                }\r\n            },\r\n            setConfigs() {\r\n                let vm = this;\r\n                let globalOptions;\r\n                if (typeof vm.$getOptions !== \"undefined\") {\r\n                    // Global Options\r\n                    globalOptions = vm.$getOptions();\r\n                    Object.keys(globalOptions).forEach(function (objectKey) {\r\n                        if (typeof (vm.fConfigs[objectKey]) !== \"undefined\") {\r\n                            vm.$set(vm.fConfigs, objectKey, globalOptions[objectKey]);\r\n                        }\r\n                    });\r\n                }\r\n\r\n                if (typeof (vm.configs) !== \"undefined\") {\r\n                    Object.keys(vm.fConfigs).forEach(function (objectKey) {\r\n                        if (typeof (vm.configs[objectKey]) !== \"undefined\") {\r\n                            // Get From Configs\r\n                            vm.$set(vm.fConfigs, objectKey, vm.configs[objectKey]);\r\n                        }\r\n                    });\r\n                } else {\r\n                    Object.keys(vm.$props).forEach(function (objectKey) {\r\n                        if (typeof (vm.fConfigs[objectKey]) !== \"undefined\" &&\r\n                            typeof (vm.$props[objectKey]) !== \"undefined\") {\r\n                            vm.$set(vm.fConfigs, objectKey, vm.$props[objectKey]);\r\n                        }\r\n                    });\r\n                }\r\n\r\n\r\n                // Is Modal\r\n                if (vm.fConfigs.isModal) vm.showCalendar = false;\r\n\r\n                // Placeholder\r\n                if (!vm.fConfigs.placeholder) vm.fConfigs.placeholder = vm.fConfigs.dateFormat;\r\n\r\n                if (typeof vm.newCurrentDate !== \"undefined\") {\r\n                    vm.calendar.currentDate = vm.newCurrentDate;\r\n                }\r\n\r\n                // Sunday Start\r\n                if (vm.fConfigs.sundayStart) {\r\n                    let dayNames = vm.fConfigs.dayNames;\r\n                    let sundayName = dayNames[dayNames.length - 1];\r\n                    dayNames.splice(dayNames.length - 1, 1);\r\n                    dayNames.unshift(sundayName);\r\n                }\r\n            },\r\n            listRendering() {\r\n                let vm = this;\r\n\r\n                // Each Calendars\r\n                vm.listCalendars.forEach(function (calendar) {\r\n                    // Set Calendar Weeks\r\n                    calendar.weeks.forEach(function (week) {\r\n\r\n                        let finalizedDays = [];\r\n\r\n                        week.days.forEach(function (day) {\r\n                            let date = new Date(day.year, day.month, day.day);\r\n                            let now = new Date();\r\n\r\n                            let isToday = false;\r\n\r\n                            date.setHours(0, 0, 0, 0);\r\n                            now.setHours(0, 0, 0, 0);\r\n\r\n                            if (date.getTime() === now.getTime()) {\r\n                                isToday = true;\r\n                            }\r\n\r\n                            let checkMarked;\r\n                            // With Custom Classes\r\n                            if (typeof vm.fConfigs.markedDates[0] === \"object\") {\r\n                                checkMarked = vm.fConfigs.markedDates.find(function (markDate) {\r\n                                    return markDate.date === helpCalendar.formatDate(date)\r\n                                });\r\n                            } else {\r\n                                // Without Classes\r\n                                checkMarked = vm.fConfigs.markedDates.find(function (markDate) {\r\n                                    return markDate === helpCalendar.formatDate(date)\r\n                                });\r\n                            }\r\n\r\n                            if (vm.calendar.dateRange.start.date === helpCalendar.formatDate(date)) {\r\n                                checkMarked = true;\r\n                            }\r\n\r\n                            let isMarked = false;\r\n                            if (typeof checkMarked !== \"undefined\") {\r\n                                isMarked = true;\r\n                            }\r\n\r\n                            finalizedDays.push({\r\n                                day: day.day,\r\n                                date: helpCalendar.formatDate(date),\r\n                                hide: day.hide,\r\n                                isMouseToLeft: false,\r\n                                isMouseToRight: false,\r\n                                isHovered: false,\r\n                                isDateRangeStart: vm.checkDateRangeStart(helpCalendar.formatDate(date)),\r\n                                isDateRangeEnd: vm.checkDateRangeEnd(helpCalendar.formatDate(date)),\r\n                                hideLeftAndRightDays: day.hideLeftAndRightDays,\r\n                                isToday: isToday,\r\n                                isMarked: isMarked\r\n                            });\r\n                        });\r\n\r\n                        week.days = finalizedDays;\r\n                    });\r\n                });\r\n\r\n            },\r\n            clickDay(item) {\r\n                if (!this.fConfigs.isDateRange && !this.fConfigs.isDatePicker && !this.fConfigs.isMultipleDatePicker) {\r\n                    return false;\r\n                }\r\n\r\n                //Disabled Dates - Start\r\n\r\n                // Disable days of week if set in configuration\r\n                let dateDay = helpCalendar.getDateFromFormat(item.date).getDay() - 1;\r\n                if (dateDay === -1) {\r\n                    dateDay = 6;\r\n                }\r\n\r\n                let dayOfWeekString = this.fConfigs.dayNames[dateDay];\r\n                if (this.fConfigs.disabledDayNames.includes(dayOfWeekString) || this.isDisabledDate(item.date)) {\r\n                    return false;\r\n                }\r\n\r\n                //Disabled Dates - End\r\n\r\n                // Limits\r\n                if (this.fConfigs.limits) {\r\n                    let min = helpCalendar.getDateFromFormat(this.fConfigs.limits.min).getTime();\r\n                    let max = helpCalendar.getDateFromFormat(this.fConfigs.limits.max).getTime();\r\n                    let date = helpCalendar.getDateFromFormat(item.date).getTime();\r\n\r\n                    if (date < min || date > max) {\r\n                        return false;\r\n                    }\r\n                }\r\n\r\n                // Date Range\r\n                if (this.fConfigs.isDateRange) {\r\n\r\n                    let clickDate = helpCalendar.getDateFromFormat(item.date).getTime();\r\n\r\n                    let startDate = false;\r\n                    if (this.calendar.dateRange.start.date) {\r\n                        startDate = helpCalendar.getDateFromFormat(this.calendar.dateRange.start.date);\r\n                    }\r\n\r\n                    // Two dates is not empty\r\n                    if (this.calendar.dateRange.start.date !== false && this.calendar.dateRange.end.date !== false) {\r\n                        this.calendar.dateRange.start.date = item.date;\r\n                        this.calendar.dateRange.end.date = false;\r\n                        // Not date selected\r\n                    } else if (this.calendar.dateRange.start.date === false && this.calendar.dateRange.end.date === false) {\r\n                        this.calendar.dateRange.start.date = item.date;\r\n                        // Start Date not empty, chose date > start date\r\n                    } else if (this.calendar.dateRange.end.date === false && (clickDate > startDate.getTime())) {\r\n                        this.calendar.dateRange.end.date = item.date;\r\n                        // Start date not empty, chose date <= start date (also same date range select)\r\n                    } else if (this.calendar.dateRange.start.date !== false && (clickDate <= startDate.getTime())) {\r\n                        this.calendar.dateRange.end.date = this.calendar.dateRange.start.date;\r\n                        this.calendar.dateRange.start.date = item.date;\r\n                    }\r\n\r\n                    //Get number of days between date range dates\r\n                    if (this.calendar.dateRange.start.date !== false && this.calendar.dateRange.end.date !== false) {\r\n                        let oneDay = 24 * 60 * 60 * 1000;\r\n                        let firstDate = helpCalendar.getDateFromFormat(this.calendar.dateRange.start.date);\r\n                        let secondDate = helpCalendar.getDateFromFormat(this.calendar.dateRange.end.date);\r\n                        let diffDays = Math.round(Math.abs((firstDate.getTime() - secondDate.getTime()) / (oneDay)));\r\n                        let itemTime = helpCalendar.getDateFromFormat(item.date).getTime();\r\n\r\n                        this.$emit('selectedDaysCount', diffDays);\r\n\r\n                        // Is Auto Closeable\r\n                        if (this.fConfigs.isModal && this.fConfigs.isAutoCloseable) {\r\n                            this.showCalendar = false;\r\n                        }\r\n\r\n\r\n                        // Minimum Selected Days\r\n                        let minSelDays = this.fConfigs.minSelDays;\r\n\r\n                        if (minSelDays && itemTime >= startDate.getTime() && diffDays < minSelDays) {\r\n                            startDate.setDate(startDate.getDate() + (minSelDays - 1));\r\n                            this.calendar.dateRange.end.date = helpCalendar.formatDate(startDate);\r\n                        }\r\n\r\n                        if (minSelDays && itemTime < startDate.getTime() && diffDays < minSelDays) {\r\n                            startDate.setDate(startDate.getDate() - (minSelDays - 1));\r\n                            this.calendar.dateRange.start.date = helpCalendar.formatDate(startDate);\r\n                        }\r\n\r\n                        // Maximum Selected Days\r\n                        let maxSelDays = this.fConfigs.maxSelDays;\r\n\r\n                        if (maxSelDays && itemTime >= startDate.getTime() && diffDays >= maxSelDays) {\r\n                            startDate.setDate(startDate.getDate() + (maxSelDays - 1));\r\n                            this.calendar.dateRange.end.date = helpCalendar.formatDate(startDate);\r\n                        }\r\n\r\n                        if (maxSelDays && itemTime < startDate.getTime() && diffDays >= maxSelDays) {\r\n                            startDate.setDate(startDate.getDate() - (maxSelDays - 1));\r\n                            this.calendar.dateRange.start.date = helpCalendar.formatDate(startDate);\r\n                        }\r\n                    }\r\n\r\n                    this.$emit('input', this.calendar);\r\n                } else if (this.fConfigs.isDatePicker) {\r\n                    this.calendar.selectedDate = item.date;\r\n                    this.$emit('input', this.calendar);\r\n\r\n                    // Is Auto Closeable\r\n                    if (this.fConfigs.isModal && this.fConfigs.isAutoCloseable) {\r\n                        this.showCalendar = false;\r\n                    }\r\n                } else if (this.fConfigs.isMultipleDatePicker) {\r\n                    if (this.calendar.selectedDates.find(date => date.date === item.date)) {\r\n                        let dateIndex = this.calendar.selectedDates.findIndex(date => date.date === item.date);\r\n                        this.calendar.selectedDates.splice(dateIndex, 1);\r\n                    } else {\r\n                        let date = Object.assign({}, this.defaultDateFormat);\r\n                        date.date = item.date;\r\n                        this.calendar.selectedDates.push(date);\r\n                    }\r\n\r\n                    this.$emit('input', this.calendar);\r\n                }\r\n\r\n                this.markChooseDays();\r\n\r\n                // Time Picker\r\n                if (this.fConfigs.withTimePicker) {\r\n                    if (this.fConfigs.isDateRange || this.fConfigs.isDatePicker) {\r\n                        this.openTimePicker();\r\n                    }\r\n\r\n                    if (this.calendar.selectedDates.find(date => date.date === item.date) && this.fConfigs.isMultipleDatePicker) {\r\n                        this.openTimePicker();\r\n                    }\r\n                }\r\n\r\n                this.$emit('choseDay', item);\r\n            },\r\n            markChooseDays() {\r\n                let vm = this;\r\n                let startDate = vm.calendar.dateRange.start.date;\r\n                let endDate = vm.calendar.dateRange.end.date;\r\n\r\n                this.listCalendars.forEach((calendar) => {\r\n                    calendar.weeks.forEach((week) => {\r\n                        week.days.forEach((day) => {\r\n\r\n                            day.isMarked = false;\r\n\r\n                            // Date Picker\r\n                            if (vm.fConfigs.isDatePicker) {\r\n                                if (this.calendar.selectedDate === day.date)\r\n                                    day.isMarked = true;\r\n                            } else if (vm.fConfigs.isMultipleDatePicker) {\r\n                                if (vm.calendar.selectedDates.find(date => date.date === day.date))\r\n                                    day.isMarked = true;\r\n                            } else {\r\n                                day.isMouseToLeft = false;\r\n                                day.isMouseToRight = false;\r\n\r\n                                // Date Range\r\n                                if (startDate === day.date) {\r\n                                    day.isMouseToLeft = !!endDate;\r\n                                    day.isMarked = true;\r\n                                }\r\n\r\n                                if (endDate === day.date) {\r\n                                    day.isMouseToRight = !!endDate;\r\n                                    day.isMarked = true;\r\n                                }\r\n\r\n                                if (startDate && startDate === endDate) {\r\n                                    day.isMouseToLeft = false;\r\n                                    day.isMouseToRight = false;\r\n                                }\r\n\r\n                                if (startDate && endDate) {\r\n                                    if (helpCalendar.getDateFromFormat(day.date).getTime() > helpCalendar.getDateFromFormat(startDate)\r\n                                        && helpCalendar.getDateFromFormat(day.date) < helpCalendar.getDateFromFormat(endDate)) {\r\n                                        day.isMarked = true;\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            if (this.fConfigs.markedDates.includes(day.date))\r\n                                day.isMarked = true;\r\n                        })\r\n                    })\r\n                })\r\n            },\r\n            dayMouseOver(week_key, date) {\r\n                if (!this.fConfigs.isDateRange) {\r\n                    return false;\r\n                }\r\n\r\n                // Limits\r\n                if (this.fConfigs.limits) {\r\n                    let limitMin = helpCalendar.getDateFromFormat(this.fConfigs.limits.min).getTime();\r\n                    let limitMax = helpCalendar.getDateFromFormat(this.fConfigs.limits.max).getTime();\r\n                    let limitDate = helpCalendar.getDateFromFormat(date).getTime();\r\n\r\n                    if (limitDate < limitMin || limitDate > limitMax) {\r\n                        return false;\r\n                    }\r\n                }\r\n\r\n                if ((this.calendar.dateRange.start.date === false || this.calendar.dateRange.end.date === false)\r\n                    && (this.calendar.dateRange.start.date !== false || this.calendar.dateRange.end.date !== false)) {\r\n\r\n                    for (let e = 0; e < this.listCalendars.length; e++) {\r\n                        let calendar = this.listCalendars[e];\r\n\r\n                        for (let f = 0; f < calendar.weeks.length; f++) {\r\n                            let week = calendar.weeks[f];\r\n\r\n                            for (let i = 0; i < week.days.length; i++) {\r\n\r\n                                let item = week.days[i];\r\n\r\n                                this.listCalendars[e].weeks[f].days[i].isHovered = false;\r\n\r\n                                if (item.date !== this.calendar.dateRange.start.date && !this.fConfigs.markedDates.includes(item.date)) {\r\n                                    this.listCalendars[e].weeks[f].days[i].isMarked = false;\r\n                                }\r\n\r\n                                if (this.calendar.dateRange.start.date) {\r\n                                    let itemDate = helpCalendar.getDateFromFormat(item.date).getTime();\r\n                                    let thisDate = helpCalendar.getDateFromFormat(date).getTime();\r\n                                    let startDate = helpCalendar.getDateFromFormat(this.calendar.dateRange.start.date);\r\n\r\n                                    this.listCalendars[e].weeks[f].days[i].isMouseToLeft = (itemDate === startDate.getTime() && thisDate > startDate.getTime()) || (itemDate === thisDate && thisDate < startDate.getTime());\r\n                                    this.listCalendars[e].weeks[f].days[i].isMouseToRight = (itemDate === startDate.getTime() && thisDate < startDate.getTime()) || (itemDate === thisDate && thisDate > startDate.getTime());\r\n\r\n                                    let dateDay = helpCalendar.getDateFromFormat(item.date).getDay() - 1;\r\n                                    if (dateDay === -1) {\r\n                                        dateDay = 6;\r\n                                    }\r\n\r\n                                    let dayOfWeekString = this.fConfigs.dayNames[dateDay];\r\n                                    if (!this.fConfigs.disabledDayNames.includes(dayOfWeekString) &&\r\n                                        ((itemDate > startDate.getTime() && itemDate < thisDate)\r\n                                            ||\r\n                                            (itemDate < startDate.getTime() && itemDate > thisDate))\r\n                                    ) {\r\n                                        this.listCalendars[e].weeks[f].days[i].isMarked = true;\r\n                                    }\r\n\r\n                                    if (!this.calendar.dateRange.end.date && itemDate === thisDate) {\r\n                                        this.listCalendars[e].weeks[f].days[i].isHovered = true;\r\n                                    }\r\n\r\n                                    if (this.checkSelDates('min', this.calendar.dateRange.start.date, item.date, date)) {\r\n                                        this.listCalendars[e].weeks[f].days[i].isMarked = true;\r\n\r\n                                        let minDateToRight, minDateToLeft;\r\n                                        minDateToLeft = new Date(startDate.getTime());\r\n                                        minDateToRight = new Date(startDate.getTime());\r\n                                        minDateToLeft.setDate(minDateToLeft.getDate() - this.fConfigs.minSelDays + 1);\r\n                                        minDateToRight.setDate(minDateToRight.getDate() + this.fConfigs.minSelDays - 1);\r\n\r\n                                        if (thisDate >= minDateToLeft.getTime() && helpCalendar.formatDate(minDateToLeft) === item.date) {\r\n                                            this.listCalendars[e].weeks[f].days[i].isMarked = false;\r\n                                            this.listCalendars[e].weeks[f].days[i].isMouseToLeft = true;\r\n                                            this.listCalendars[e].weeks[f].days[i].isHovered = true;\r\n                                        } else if (thisDate <= minDateToRight.getTime() && helpCalendar.formatDate(minDateToRight) === item.date) {\r\n                                            this.listCalendars[e].weeks[f].days[i].isMarked = false;\r\n                                            this.listCalendars[e].weeks[f].days[i].isMouseToRight = true;\r\n                                            this.listCalendars[e].weeks[f].days[i].isHovered = true;\r\n                                        }\r\n                                    }\r\n\r\n                                    if (this.checkSelDates('max', this.calendar.dateRange.start.date, item.date, date)) {\r\n                                        this.listCalendars[e].weeks[f].days[i].isMarked = false;\r\n                                        this.listCalendars[e].weeks[f].days[i].isHovered = false;\r\n                                        this.listCalendars[e].weeks[f].days[i].isMouseToLeft = false;\r\n                                        this.listCalendars[e].weeks[f].days[i].isMouseToRight = false;\r\n\r\n                                        let maxDateToLeft, maxDateToRight;\r\n                                        maxDateToLeft = new Date(startDate.getTime());\r\n                                        maxDateToRight = new Date(startDate.getTime());\r\n                                        maxDateToLeft.setDate(maxDateToLeft.getDate() - this.fConfigs.maxSelDays + 1);\r\n                                        maxDateToRight.setDate(maxDateToRight.getDate() + this.fConfigs.maxSelDays - 1);\r\n\r\n                                        if (thisDate <= maxDateToLeft.getTime()) {\r\n                                            if (helpCalendar.formatDate(maxDateToLeft) === item.date) {\r\n                                                this.listCalendars[e].weeks[f].days[i].isHovered = true;\r\n                                                this.listCalendars[e].weeks[f].days[i].isMouseToLeft = true;\r\n                                            }\r\n                                        }\r\n\r\n                                        if (thisDate >= maxDateToRight.getTime()) {\r\n                                            if (helpCalendar.formatDate(maxDateToRight) === item.date) {\r\n                                                this.listCalendars[e].weeks[f].days[i].isHovered = true;\r\n                                                this.listCalendars[e].weeks[f].days[i].isMouseToRight = true;\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            /**\r\n             * @return {boolean}\r\n             */\r\n            PreMonth(calendarKey = null) {\r\n                if (!this.allowPreDate)\r\n                    return false;\r\n\r\n                this.transitionPrefix = 'right';\r\n\r\n                calendarKey = calendarKey !== null ? calendarKey : 0;\r\n\r\n                let currentCalendar = this.listCalendars[calendarKey];\r\n                currentCalendar.date = new Date(currentCalendar.date.getFullYear(), currentCalendar.date.getMonth() - 1);\r\n                currentCalendar.key -= 1;\r\n                this.updateCalendar();\r\n\r\n                if (!this.fConfigs.isSeparately) {\r\n                    this.calendar.currentDate = currentCalendar.date;\r\n                    this.initCalendar();\r\n                }\r\n\r\n                this.$emit('changedMonth', currentCalendar.date);\r\n            },\r\n            /**\r\n             * @return {boolean}\r\n             */\r\n            NextMonth(calendarKey = null) {\r\n                if (!this.allowNextDate)\r\n                    return false;\r\n\r\n                this.transitionPrefix = 'left';\r\n\r\n                calendarKey = calendarKey !== null ? calendarKey : 0;\r\n\r\n                let currentCalendar = this.listCalendars[calendarKey];\r\n                currentCalendar.date = new Date(currentCalendar.date.getFullYear(), currentCalendar.date.getMonth() + 1);\r\n                currentCalendar.key += 1;\r\n                this.updateCalendar();\r\n\r\n                if (!this.fConfigs.isSeparately) {\r\n                    this.calendar.currentDate = currentCalendar.date;\r\n                    this.initCalendar();\r\n                }\r\n\r\n                this.$emit('changedMonth', currentCalendar.date);\r\n            },\r\n            /**\r\n             * @return {boolean}\r\n             */\r\n            PreYear(calendarKey = null) {\r\n                if (!this.allowPreDate)\r\n                    return false;\r\n\r\n                let step = this.showYearPicker ? this.fConfigs.changeYearStep : 1;\r\n\r\n                calendarKey = calendarKey !== null ? calendarKey : 0;\r\n\r\n                let currentCalendar = this.listCalendars[calendarKey];\r\n                currentCalendar.date = new Date(currentCalendar.date.getFullYear() - step, currentCalendar.date.getMonth());\r\n                this.updateCalendar();\r\n\r\n\r\n                if (!this.fConfigs.isSeparately) {\r\n                    this.calendar.currentDate = currentCalendar.date;\r\n                    this.initCalendar();\r\n                }\r\n\r\n                this.$emit('changedYear', currentCalendar.date);\r\n\r\n            },\r\n            /**\r\n             * @return {boolean}\r\n             */\r\n            NextYear(calendarKey = null) {\r\n                if (!this.allowNextDate)\r\n                    return false;\r\n\r\n                let step = this.showYearPicker ? this.fConfigs.changeYearStep : 1;\r\n\r\n                calendarKey = calendarKey !== null ? calendarKey : 0;\r\n\r\n                let currentCalendar = this.listCalendars[calendarKey];\r\n                currentCalendar.date = new Date(currentCalendar.date.getFullYear() + step, currentCalendar.date.getMonth());\r\n                this.updateCalendar();\r\n\r\n                if (!this.fConfigs.isSeparately) {\r\n                    this.calendar.currentDate = currentCalendar.date;\r\n                    this.initCalendar();\r\n                }\r\n\r\n                this.$emit('changedYear', currentCalendar.date);\r\n            },\r\n            ChooseDate(date) {\r\n                let newDate = helpCalendar.getDateFromFormat(date);\r\n\r\n                if (date === 'today') {\r\n                    newDate = new Date();\r\n                }\r\n\r\n                this.listCalendars[0].date = this.calendar.currentDate = newDate;\r\n\r\n                this.updateCalendar();\r\n                this.initCalendar();\r\n            },\r\n            openMonthPicker(key) {\r\n                if (this.fConfigs.changeMonthFunction) {\r\n                    this.showMonthPicker = (key === this.showMonthPicker) ? false : key;\r\n                    this.showYearPicker = false;\r\n                }\r\n            },\r\n            openYearPicker(key) {\r\n                if (this.fConfigs.changeYearFunction) {\r\n                    this.showYearPicker = (key === this.showYearPicker) ? false : key;\r\n                    this.showMonthPicker = false;\r\n                }\r\n            },\r\n            openTimePicker() {\r\n                this.showTimePicker = true;\r\n            },\r\n            pickMonth(key, calendarKey) {\r\n                this.showMonthPicker = false;\r\n\r\n                let currentCalendar = this.listCalendars[calendarKey];\r\n                let date = currentCalendar.date;\r\n                currentCalendar.date = new Date(date.getFullYear(), key + 1, 0);\r\n                this.updateCalendar();\r\n            },\r\n            pickYear(year, calendarKey) {\r\n                this.showYearPicker = false;\r\n\r\n                let currentCalendar = this.listCalendars[calendarKey];\r\n                let date = currentCalendar.date;\r\n                currentCalendar.date = new Date(year, date.getMonth() + 1, 0);\r\n                this.updateCalendar();\r\n            },\r\n            getYearList(date) {\r\n                let years = [];\r\n                let year = date.getFullYear() - 4;\r\n                for (let i = 0; i < 12; i++) {\r\n                    let finalYear = year + i;\r\n\r\n                    years.push({\r\n                        year: finalYear\r\n                    });\r\n                }\r\n                return years;\r\n            },\r\n            getClassNames(day) {\r\n                let classes = [];\r\n\r\n                // Disable days of week if set in configuration\r\n                let dateDay = helpCalendar.getDateFromFormat(day.date).getDay() - 1;\r\n                if (dateDay === -1) {\r\n                    dateDay = 6;\r\n                }\r\n                let dayOfWeekString = this.fConfigs.dayNames[dateDay];\r\n                if (this.fConfigs.disabledDayNames.includes(dayOfWeekString)) {\r\n                    day.hide = true;\r\n                    classes.push('vfc-cursor-not-allowed');\r\n                }\r\n\r\n                let date = helpCalendar.getDateFromFormat(day.date);\r\n                let today = new Date();\r\n                today.setHours(0, 0, 0, 0);\r\n\r\n\r\n                // Disabled dates\r\n                if (this.isDisabledDate(day.date)) {\r\n                    classes.push('vfc-disabled');\r\n                    classes.push('vfc-cursor-not-allowed');\r\n                }\r\n\r\n                if (this.fConfigs.limits) {\r\n                    let min = helpCalendar.getDateFromFormat(this.fConfigs.limits.min).getTime();\r\n                    let max = helpCalendar.getDateFromFormat(this.fConfigs.limits.max).getTime();\r\n\r\n                    if (date.getTime() < min || date.getTime() > max) {\r\n                        classes.push('vfc-disabled');\r\n                        classes.push('vfc-cursor-not-allowed');\r\n                    }\r\n                }\r\n\r\n                if (day.hide) {\r\n                    classes.push('vfc-hide');\r\n                }\r\n\r\n                // Today date\r\n                if (day.isToday) {\r\n                    classes.push('vfc-today');\r\n                }\r\n\r\n                if (!day.hideLeftAndRightDays && !this.fConfigs.disabledDayNames.includes(dayOfWeekString)) {\r\n\r\n                    // Mark Date\r\n                    if (day.isMarked) {\r\n                        classes.push('vfc-marked');\r\n                    } else if (day.isHovered) {\r\n                        classes.push('vfc-hovered');\r\n                    }\r\n\r\n                    if (this.fConfigs.markedDates.includes(day.date)) {\r\n                        classes.push('vfc-borderd');\r\n                    }\r\n\r\n                    if (Array.isArray(this.fConfigs.markedDateRange)) {\r\n                        this.fConfigs.markedDateRange.forEach(range => {\r\n                            if (helpCalendar.getDateFromFormat(range.start) <= helpCalendar.getDateFromFormat(day.date)\r\n                                && helpCalendar.getDateFromFormat(range.end) >= helpCalendar.getDateFromFormat(day.date)) {\r\n                                classes.push('vfc-marked');\r\n                            }\r\n\r\n                            if (day.date === range.start) {\r\n                                classes.push('vfc-start-marked');\r\n                            } else if (day.date === range.end) {\r\n                                classes.push('vfc-end-marked');\r\n                            }\r\n                        })\r\n                    } else if (this.fConfigs.markedDateRange.start && this.fConfigs.markedDateRange.end) {\r\n                        // Date Range Marked\r\n                        if (helpCalendar.getDateFromFormat(this.fConfigs.markedDateRange.start) <= helpCalendar.getDateFromFormat(day.date)\r\n                            && helpCalendar.getDateFromFormat(this.fConfigs.markedDateRange.end) >= helpCalendar.getDateFromFormat(day.date)) {\r\n                            classes.push('vfc-marked');\r\n                        }\r\n\r\n                        if (day.date === this.fConfigs.markedDateRange.start) {\r\n                            classes.push('vfc-start-marked');\r\n                        } else if (day.date === this.fConfigs.markedDateRange.end) {\r\n                            classes.push('vfc-end-marked');\r\n                        }\r\n                    } else {\r\n                        // Only After Start Marked\r\n                        if (this.fConfigs.markedDateRange.start) {\r\n                            if (helpCalendar.getDateFromFormat(this.fConfigs.markedDateRange.start) <= helpCalendar.getDateFromFormat(day.date))\r\n                                classes.push('vfc-marked');\r\n                        }\r\n\r\n                        // Only Before End Marked\r\n                        if (this.fConfigs.markedDateRange.end) {\r\n                            if (helpCalendar.getDateFromFormat(this.fConfigs.markedDateRange.end) >= helpCalendar.getDateFromFormat(day.date))\r\n                                classes.push('vfc-marked');\r\n                        }\r\n                    }\r\n\r\n                    classes.push('vfc-hover');\r\n                }\r\n\r\n\r\n                // Date Mark With Custom Classes\r\n                if (typeof this.fConfigs.markedDates === \"object\") {\r\n                    let checkMarked = this.fConfigs.markedDates.find(function (markDate) {\r\n                        return markDate.date === day.date;\r\n                    });\r\n\r\n                    if (typeof checkMarked !== \"undefined\") {\r\n                        classes.push(checkMarked.class);\r\n                    }\r\n                }\r\n\r\n                if (day.date === this.calendar.dateRange.start.date) {\r\n                    classes.push('vfc-start-marked');\r\n                }\r\n\r\n                if (day.date === this.calendar.dateRange.end.date) {\r\n                    classes.push('vfc-end-marked');\r\n                }\r\n\r\n                if (day.date === this.calendar.selectedDate || this.calendar.selectedDates.find(sDate => sDate.date === day.date)) {\r\n                    classes.push('vfc-borderd')\r\n                }\r\n\r\n                return classes;\r\n            },\r\n            checkDateRangeStart(date) {\r\n                if (Array.isArray(this.fConfigs.markedDateRange)) {\r\n                    return this.fConfigs.markedDateRange.findIndex(range => {\r\n                        return range.start === date;\r\n                    }) !== -1;\r\n                }\r\n\r\n                return date === this.fConfigs.markedDateRange.start;\r\n            },\r\n            checkDateRangeEnd(date) {\r\n                if (Array.isArray(this.fConfigs.markedDateRange)) {\r\n                    return this.fConfigs.markedDateRange.findIndex(range => {\r\n                        return range.end === date;\r\n                    }) !== -1;\r\n                }\r\n\r\n                return date === this.fConfigs.markedDateRange.end;\r\n            },\r\n            checkSelDates(type, startDate, itemDate, hoverDate) {\r\n                let startTime = helpCalendar.getDateFromFormat(startDate).getTime();\r\n                let itemTime = helpCalendar.getDateFromFormat(itemDate).getTime();\r\n                let hoverTime = helpCalendar.getDateFromFormat(hoverDate).getTime();\r\n\r\n                let days = type === 'min' ? this.fConfigs.minSelDays : this.fConfigs.maxSelDays - 2;\r\n                let minTime = days * 1000 * 60 * 60 * 24;\r\n                let rightTime = startTime + minTime;\r\n                let leftTime = startTime - minTime;\r\n\r\n                let result;\r\n                if (hoverTime > startTime) {\r\n                    if (type === 'min')\r\n                        result = itemTime < rightTime && itemTime > startTime && this.fConfigs.minSelDays;\r\n                    else\r\n                        result = itemTime > rightTime && itemTime > startTime && this.fConfigs.maxSelDays;\r\n                } else if (hoverTime < startTime) {\r\n                    if (type === 'min')\r\n                        result = itemTime > leftTime && itemTime < startTime && this.fConfigs.minSelDays;\r\n                    else\r\n                        result = itemTime < leftTime && itemTime < startTime && this.fConfigs.maxSelDays;\r\n                }\r\n\r\n                return result;\r\n            },\r\n            checkLimits(value) {\r\n                if (this.fConfigs.limits) {\r\n                    let min = new Date(helpCalendar.getDateFromFormat(this.fConfigs.limits.min));\r\n                    min.setDate(1);\r\n                    min.setHours(0, 0, 0, 0);\r\n                    let max = new Date(helpCalendar.getDateFromFormat(this.fConfigs.limits.max));\r\n                    max.setDate(1);\r\n                    max.setHours(0, 0, 0, 0);\r\n\r\n                    this.allowPreDate = true;\r\n                    this.allowNextDate = true;\r\n\r\n                    let current = new Date(value);\r\n                    current.setDate(1);\r\n                    current.setHours(0, 0, 0, 0);\r\n\r\n                    if (current <= min) {\r\n                        this.allowPreDate = false;\r\n                    }\r\n\r\n                    if (current >= max) {\r\n                        this.allowNextDate = false;\r\n                    }\r\n                }\r\n            },\r\n            getTransition_() {\r\n                if (!this.fConfigs.transition)\r\n                    return '';\r\n\r\n                let name = '';\r\n                if (this.transitionPrefix === 'left') {\r\n                    name = 'vfc-calendar-slide-left';\r\n                } else if (this.transitionPrefix === 'right') {\r\n                    name = 'vfc-calendar-slide-right';\r\n                }\r\n                return name;\r\n            },\r\n            setCalendarStyles() {\r\n                let day = this.$refs.day[0];\r\n                let container = this.$refs.mainContainer;\r\n\r\n                container.style.display = \"\";\r\n                let height = container.clientHeight + (day.clientHeight + (day.clientHeight / 2.5));\r\n                container.style.height = height + \"px\";\r\n\r\n                if (this.fConfigs.isModal) {\r\n                    container.style.display = \"none\"\r\n                }\r\n            },\r\n            checkHiddenElement(elementName) {\r\n                return !this.fConfigs.hiddenElements.includes(elementName);\r\n            },\r\n            canCalendarClosed(e) {\r\n                if (!this.$el.contains(e.target)) {\r\n                    return this.showCalendar = false\r\n                }\r\n                return true;\r\n            },\r\n            isDisabledDate(date) {\r\n                let today = new Date();\r\n                today.setHours(0, 0, 0, 0);\r\n                let dateObj = helpCalendar.getDateFromFormat(date);\r\n\r\n                return this.fConfigs.disabledDates.includes(date) ||\r\n                    (this.fConfigs.disabledDates.includes('beforeToday') && dateObj.getTime() < today.getTime()) ||\r\n                    (this.fConfigs.disabledDates.includes('afterToday') && dateObj.getTime() > today.getTime())\r\n            },\r\n            hideMonthYearPicker(e) {\r\n                if (this.showMonthPicker || this.showYearPicker) {\r\n                    let key = this.showMonthPicker ? this.showMonthPicker - 1 : this.showYearPicker - 1;\r\n\r\n                    let element1 = this.$refs.calendars.querySelector(`.vfc-calendars .vfc-calendar:nth-child(${key + 1}) .vfc-top-date a:nth-child(1)`);\r\n                    let element2 = this.$refs.calendars.querySelector(`.vfc-calendars .vfc-calendar:nth-child(${key + 1}) .vfc-top-date a:nth-child(2)`);\r\n\r\n                    if (!this.$refs.monthContainer[key].$el.contains(e.target) && !element1.contains(e.target) && !element2.contains(e.target)) {\r\n                        return this.showMonthPicker = this.showYearPicker = false\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n    .vfc-styles-conditional-class {\r\n        @import \"../assets/scss/calendar.scss\";\r\n    }\r\n</style>\r\n"]}]}